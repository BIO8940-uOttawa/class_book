<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Introduction to GLMM | BIO8940 Advanced stats and Open Science</title>
  <meta name="description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Introduction to GLMM | BIO8940 Advanced stats and Open Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/missing.png" />
  <meta property="og:description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="github-repo" content="BIO8940-uOttawa/class_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Introduction to GLMM | BIO8940 Advanced stats and Open Science" />
  
  <meta name="twitter:description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="twitter:image" content="images/missing.png" />

<meta name="author" content="Julien Martin" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-linear-mixed-models.html"/>
<link rel="next" href="conclusions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced stats and open science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Note</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#quelques-points-importants-à-retenir"><i class="fa fa-check"></i>Quelques points importants à retenir</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#quest-ce-que-r-et-pourquoi-lutiliser-dans-ce-cours"><i class="fa fa-check"></i>Qu’est-ce que R et pourquoi l’utiliser dans ce cours?</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#installation-des-logiciels-nécessaires"><i class="fa fa-check"></i>Installation des logiciels nécessaires</a><ul>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="0.0.1" data-path="préface.html"><a href="préface.html#text-editor-or-ide"><i class="fa fa-check"></i><b>0.0.1</b> Text editor or IDE</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#paquets-pour-r"><i class="fa fa-check"></i>Paquets pour R</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#pandoc"><i class="fa fa-check"></i>pandoc</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#latex"><i class="fa fa-check"></i>laTex</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#instructions-générales-pour-les-laboratoires"><i class="fa fa-check"></i>Instructions générales pour les laboratoires</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#notes-sur-le-manuel"><i class="fa fa-check"></i>Notes sur le manuel</a><ul>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Open Science</b></span></li>
<li class="chapter" data-level="1" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html"><i class="fa fa-check"></i><b>1</b> Introduction to open Science</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-rmarkdown.html"><a href="introduction-to-rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduction to Rmarkdown</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-rmarkdown.html"><a href="introduction-to-rmarkdown.html#practical"><i class="fa fa-check"></i><b>2.1</b> Practical</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-rmarkdown.html"><a href="introduction-to-rmarkdown.html#context"><i class="fa fa-check"></i><b>2.1.1</b> Context</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-rmarkdown.html"><a href="introduction-to-rmarkdown.html#questions"><i class="fa fa-check"></i><b>2.1.2</b> Questions</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction-to-rmarkdown.html"><a href="introduction-to-rmarkdown.html#happy-coding"><i class="fa fa-check"></i><b>2.1.3</b> Happy coding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-github-with-r.html"><a href="introduction-to-github-with-r.html"><i class="fa fa-check"></i><b>3</b> Introduction to github with R</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-github-with-r.html"><a href="introduction-to-github-with-r.html#practical-1"><i class="fa fa-check"></i><b>3.1</b> Practical</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-github-with-r.html"><a href="introduction-to-github-with-r.html#context-1"><i class="fa fa-check"></i><b>3.1.1</b> Context</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-github-with-r.html"><a href="introduction-to-github-with-r.html#information-of-the-data"><i class="fa fa-check"></i><b>3.1.2</b> Information of the data</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-github-with-r.html"><a href="introduction-to-github-with-r.html#questions-1"><i class="fa fa-check"></i><b>3.1.3</b> Questions</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-github-with-r.html"><a href="introduction-to-github-with-r.html#happy-github-ing"><i class="fa fa-check"></i><b>3.1.4</b> Happy git(hub)-ing</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Statistics</b></span></li>
<li class="part"><span><b>III Statistics</b></span></li>
<li class="chapter" data-level="4" data-path="refresher-on-glm.html"><a href="refresher-on-glm.html"><i class="fa fa-check"></i><b>4</b> Refresher on <code>glm</code></a></li>
<li class="chapter" data-level="5" data-path="introduction-to-linear-mixed-models.html"><a href="introduction-to-linear-mixed-models.html"><i class="fa fa-check"></i><b>5</b> Introduction to linear mixed models</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-linear-mixed-models.html"><a href="introduction-to-linear-mixed-models.html#practical-2"><i class="fa fa-check"></i><b>5.1</b> Practical</a><ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-linear-mixed-models.html"><a href="introduction-to-linear-mixed-models.html#the-superb-wild-unicorns-of-the-scottish-highlands"><i class="fa fa-check"></i><b>5.1.1</b> The superb wild unicorns of the Scottish Highlands</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-linear-mixed-models.html"><a href="introduction-to-linear-mixed-models.html#questions-2"><i class="fa fa-check"></i><b>5.1.2</b> Questions</a></li>
<li class="chapter" data-level="5.1.3" data-path="introduction-to-linear-mixed-models.html"><a href="introduction-to-linear-mixed-models.html#happy-mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Happy mixed-modelling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html"><i class="fa fa-check"></i><b>6</b> Introduction to <code>GLMM</code></a><ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#practical-3"><i class="fa fa-check"></i><b>6.1</b> Practical</a><ul>
<li class="chapter" data-level="6.1.1" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#packages-and-functions"><i class="fa fa-check"></i><b>6.1.1</b> Packages and functions</a></li>
<li class="chapter" data-level="6.1.2" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#the-data-set"><i class="fa fa-check"></i><b>6.1.2</b> The data set</a></li>
<li class="chapter" data-level="6.1.3" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#specifying-fixed-and-random-effects"><i class="fa fa-check"></i><b>6.1.3</b> Specifying fixed and random Effects</a></li>
<li class="chapter" data-level="6.1.4" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#look-at-overall-patterns-in-data"><i class="fa fa-check"></i><b>6.1.4</b> Look at overall patterns in data</a></li>
<li class="chapter" data-level="6.1.5" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#choose-an-error-distribution"><i class="fa fa-check"></i><b>6.1.5</b> Choose an error distribution</a></li>
<li class="chapter" data-level="6.1.6" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#fitting-group-wise-glm"><i class="fa fa-check"></i><b>6.1.6</b> Fitting group-wise GLM</a></li>
<li class="chapter" data-level="6.1.7" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#fitting-and-evaluating-glmms"><i class="fa fa-check"></i><b>6.1.7</b> Fitting and evaluating GLMMs</a></li>
<li class="chapter" data-level="6.1.8" data-path="introduction-to-glmm.html"><a href="introduction-to-glmm.html#inference"><i class="fa fa-check"></i><b>6.1.8</b> Inference</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>7</b> Conclusions</a></li>
<li class="part"><span><b>IV Appendix</b></span></li>
<li class="chapter" data-level="" data-path="r-1.html"><a href="r-1.html"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="to-do-list.html"><a href="to-do-list.html"><i class="fa fa-check"></i>To do list</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIO8940 Advanced stats and Open Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-glmm" class="section level1">
<h1><span class="header-section-number">6</span> Introduction to <code>GLMM</code></h1>
<div id="practical-3" class="section level2">
<h2><span class="header-section-number">6.1</span> Practical</h2>
<p>Spatial variation in nutrient availability and herbivory is likely to cause pop-ulation differentiation and maintain genetic diversity in plant populations.Here we measure the extent to which mouse-ear cress (Arabidopsis thaliana)exhibits population and genotypic variation in their responses to these im-portant environmental factors. We are particularly interested in whetherthese populations exhibit nutrient mediated compensation, where higher nutrient levels allow genotypes to better tolerate herbivory (Banta et al.,2010). We use GLMMs to estimate the effect of nutrient levels, simulated hebivory, and their interaction on fruit production in Arabidopsis thaliana(fixed effects), and the extent to which populations vary in their responses(random effects, or variance components)</p>
<div id="packages-and-functions" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Packages and functions</h3>
<p>You need to downaload the “glmm_funs.R” script for some functions used in the Practical</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="introduction-to-glmm.html#cb25-1"></a><span class="kw">library</span>(lme4)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="introduction-to-glmm.html#cb29-1"></a><span class="kw">library</span>(plyr)</span></code></pre></div>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="introduction-to-glmm.html#cb36-1"></a><span class="kw">library</span>(reshape)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;reshape&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:plyr&#39;:
## 
##     rename, round_any</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     expand</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     rename</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, smiths</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="introduction-to-glmm.html#cb42-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb42-2"><a href="introduction-to-glmm.html#cb42-2"></a><span class="kw">library</span>(gridExtra)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="introduction-to-glmm.html#cb45-1"></a><span class="kw">library</span>(lattice)</span>
<span id="cb45-2"><a href="introduction-to-glmm.html#cb45-2"></a><span class="kw">source</span>(<span class="st">&quot;data/glmm_funs.R&quot;</span>)</span></code></pre></div>
</div>
<div id="the-data-set" class="section level3">
<h3><span class="header-section-number">6.1.2</span> The data set</h3>
<p>In this data set, the response variable is the number of fruits (i.e. seedcapsules) per plant. The number of fruits produced by an individual plant(the experimental unit) was hypothesized to be a function of fixed effects,including nutrient levels (low vs. high), simulated herbivory (none vs. apicalmeristem damage), region (Sweden, Netherlands, Spain), and interactionsamong these. Fruit number was also a function of random effects including both the population and individual genotype. Because Arabidopsis is highlyselfing, seeds of a single individual served as replicates of that individual.There were also nuisance variables, including the placement of the plantin the greenhouse, and the method used to germinate seeds. These were estimated as fixed effects but interactions were excluded.</p>
<ul>
<li><code>X</code> observation number (we will use this observation number later, when we are accounting for overdispersion)</li>
<li><code>reg</code> a factor for region (Netherlands, Spain, Sweden).</li>
<li><code>popu</code> a factor with a level for each population.</li>
<li><code>gen</code> a factor with a level for each genotype.</li>
<li><code>rack</code> a nuisance factor for one of two greenhouse racks.</li>
<li><code>nutrient</code> a factor with levels for minimal or additional nutrients.</li>
<li><code>amd</code> a factor with levels for no damage or simulated herbivory (apical meristem damage; we will sometimes refer to this as “clipping”)</li>
<li><code>status</code> a nuisance factor for germination method.</li>
<li><code>total.fruits</code> the response; an integer count of the number of fruits perplant.</li>
</ul>
</div>
<div id="specifying-fixed-and-random-effects" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Specifying fixed and random Effects</h3>
<p>Here we need to select a realistic full model, based on the scientific ques-tions and the data actually at hand. We first load the data set and makesure that each variable is appropriately designated as numeric or factor (i.e.categorical variable).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="introduction-to-glmm.html#cb46-1"></a>dat_tf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Banta_TotalFruits.csv&quot;</span>)</span>
<span id="cb46-2"><a href="introduction-to-glmm.html#cb46-2"></a><span class="kw">str</span>(dat_tf)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    625 obs. of  9 variables:
##  $ X           : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ reg         : chr  &quot;NL&quot; &quot;NL&quot; &quot;NL&quot; &quot;NL&quot; ...
##  $ popu        : chr  &quot;3.NL&quot; &quot;3.NL&quot; &quot;3.NL&quot; &quot;3.NL&quot; ...
##  $ gen         : int  4 4 4 4 4 4 4 4 4 5 ...
##  $ rack        : int  2 1 1 2 2 2 2 1 2 1 ...
##  $ nutrient    : int  1 1 1 1 8 1 1 1 8 1 ...
##  $ amd         : chr  &quot;clipped&quot; &quot;clipped&quot; &quot;clipped&quot; &quot;clipped&quot; ...
##  $ status      : chr  &quot;Transplant&quot; &quot;Petri.Plate&quot; &quot;Normal&quot; &quot;Normal&quot; ...
##  $ total.fruits: int  0 0 0 0 0 0 0 3 2 0 ...</code></pre>
<p>The <code>X</code>, <code>gen</code>, <code>rack</code> and <code>nutrient</code> variables are coded as integers, but we want them to be factors.
 We use transform(), which operates within the data set, to avoid typing lots of commands like <code>dat_tf$rack &lt;- factor(dat_tf$rack)</code>
 At the same time, we reorder the <code>clipping</code> variable so that <code>"unclipped"</code> is the reference level (we could also have used <code>relevel(amd,"unclipped")</code>).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="introduction-to-glmm.html#cb48-1"></a>dat_tf &lt;-<span class="st"> </span><span class="kw">mutate</span>(</span>
<span id="cb48-2"><a href="introduction-to-glmm.html#cb48-2"></a>  dat_tf,</span>
<span id="cb48-3"><a href="introduction-to-glmm.html#cb48-3"></a>  <span class="dt">X =</span> <span class="kw">factor</span>(X),</span>
<span id="cb48-4"><a href="introduction-to-glmm.html#cb48-4"></a>  <span class="dt">gen =</span> <span class="kw">factor</span>(gen),</span>
<span id="cb48-5"><a href="introduction-to-glmm.html#cb48-5"></a>  <span class="dt">rack =</span> <span class="kw">factor</span>(rack),</span>
<span id="cb48-6"><a href="introduction-to-glmm.html#cb48-6"></a>  <span class="dt">amd =</span> <span class="kw">factor</span>(amd, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;unclipped&quot;</span>, <span class="st">&quot;clipped&quot;</span>)),</span>
<span id="cb48-7"><a href="introduction-to-glmm.html#cb48-7"></a>  <span class="dt">nutrient =</span> <span class="kw">factor</span>(nutrient, <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;High&quot;</span>))</span>
<span id="cb48-8"><a href="introduction-to-glmm.html#cb48-8"></a>)</span></code></pre></div>
<p>Now we check replication for each genotype (columns) within each population (rows).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="introduction-to-glmm.html#cb49-1"></a>(reptab &lt;-<span class="st"> </span><span class="kw">with</span>(dat_tf, <span class="kw">table</span>(popu, gen)))</span></code></pre></div>
<pre><code>##       gen
## popu    4  5  6 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 27 28 30 34 35 36
##   1.SP  0  0  0  0  0 39 26 35  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
##   1.SW  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 28 20  0  0  0  0  0
##   2.SW  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 18 14  0  0  0
##   3.NL 31 11 13  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
##   5.NL  0  0  0 35 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
##   5.SP  0  0  0  0  0  0  0  0 43 22 12  0  0  0  0  0  0  0  0  0  0  0  0  0
##   6.SP  0  0  0  0  0  0  0  0  0  0  0 13 24 14  0  0  0  0  0  0  0  0  0  0
##   7.SW  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 45 47 45
##   8.SP  0  0  0  0  0  0  0  0  0  0  0  0  0  0 13 16 35  0  0  0  0  0  0  0</code></pre>
<p><strong>Exercise</strong>: this mode of inspection is OK for this data set but might fail for much larger data sets or for more levels of nesting. See if you can think of some other numerical or graphical methods for inspecting the structure of data sets. For example,
- plot(reptab) gives a mosaic plot of the two-way table; examine this, see if you can figure out how to interpret it, and decide whether you think it might be useful
- try the commands colSums(reptab&gt;0) and table(colSums(reptab&gt;0)) (and the equivalent for rowSums) and figure out what they are telling you.
- Using this recipe, how would you compute the range of number of genotypes per treatment combination?</p>
<p>This reveals that we have only 2–4 populations per region and 2–3 genotypes per population. However, we also have 2–13 replicates per genotype for each treatment combination (four unique treatment combinations: 2 levels of nutrients by 2 levels of simulated herbivory). Thus, even though this was a reasonably large experiment (625 plants), there were a very small number of replicates with which to estimate variance components, and many more potential interactions than our data can support. Therefore, judicious selection of model terms, based on both biology and the data, is warranted. We note that we don’t really have enough levels per random effect, nor enough replication per unique treatment combination. Therefore, we decide to omit the fixed effect of “region”, although we recognize that populations in different regions are widely geographically separated.</p>
<p>We have only two random effects (population, individual), and so Laplace or Gauss-Hermite Quadrature (GHQ) should suffice, rather than requiring more complex methods. However, as in all GLMMs where the scale param- eter is treated as fixed and deviations from the fixed scale parameter would be identifiable (i.e. Poisson and binomial (N &gt; 1), but not binary, models) we may have to deal with overdispersion.</p>
</div>
<div id="look-at-overall-patterns-in-data" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Look at overall patterns in data</h3>
<p>I usually like to start with a relatively simple overall plot of the data, disregarding the random factors, just to see what’s going on. For reasons to be discussed below, we choose to look at the data on the log (or log(1 + x) scale. Let’s plot either box-and-whisker plots (useful summaries) or dot plots (more detailed, good for seeing if we missed anything).</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="introduction-to-glmm.html#cb51-1"></a><span class="kw">qplot</span>(<span class="kw">interaction</span>(nutrient, amd), <span class="kw">log</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>total.fruits), <span class="dt">data =</span> dat_tf, <span class="dt">geom =</span> <span class="st">&quot;boxplot&quot;</span>) <span class="op">+</span></span>
<span id="cb51-2"><a href="introduction-to-glmm.html#cb51-2"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>reg, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb51-3"><a href="introduction-to-glmm.html#cb51-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>))</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-21-1.svg" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="introduction-to-glmm.html#cb52-1"></a><span class="kw">qplot</span>(<span class="kw">interaction</span>(nutrient, amd), <span class="kw">log</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>total.fruits), <span class="dt">data =</span> dat_tf) <span class="op">+</span></span>
<span id="cb52-2"><a href="introduction-to-glmm.html#cb52-2"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>reg, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb52-3"><a href="introduction-to-glmm.html#cb52-3"></a><span class="st">  </span><span class="kw">stat_sum</span>() <span class="op">+</span></span>
<span id="cb52-4"><a href="introduction-to-glmm.html#cb52-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>))</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-21-2.svg" width="672" /></p>
<p><strong>Exercise</strong> generate these plots and figure out how they work before continuing. Try conditioning/faceting on population rather than region: for ggplot you might want to take out the nrow=1 specification. If you want try reorder the subplots by overall mean fruit set and/or colour the points according to the region they come from.</p>
</div>
<div id="choose-an-error-distribution" class="section level3">
<h3><span class="header-section-number">6.1.5</span> Choose an error distribution</h3>
<p>The data are non-normal in principle (i.e., count data, so our first guess would be a Poisson distribution). If we transform total fruits with the canon- ical link function (log), we hope to see relatively homogeneous variances across categories and groups.</p>
<p>First we define a new factor that represents every combination of geno-type and treatment (nutrient × clipping) treatment, and sort it in order of increasing mean fruit set.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="introduction-to-glmm.html#cb53-1"></a>dat_tf &lt;-<span class="st"> </span>dat_tf <span class="op">%&gt;%</span></span>
<span id="cb53-2"><a href="introduction-to-glmm.html#cb53-2"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb53-3"><a href="introduction-to-glmm.html#cb53-3"></a>    <span class="dt">gna =</span> <span class="kw">interaction</span>(gen, nutrient, amd),</span>
<span id="cb53-4"><a href="introduction-to-glmm.html#cb53-4"></a>    <span class="dt">gna =</span> <span class="kw">reorder</span>(gna, total.fruits, mean)</span>
<span id="cb53-5"><a href="introduction-to-glmm.html#cb53-5"></a>  )</span></code></pre></div>
<p>Now time to plot it</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="introduction-to-glmm.html#cb54-1"></a><span class="kw">ggplot</span>(dat_tf, <span class="kw">aes</span>(<span class="dt">x =</span> gna, <span class="dt">y =</span> <span class="kw">log</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>total.fruits))) <span class="op">+</span></span>
<span id="cb54-2"><a href="introduction-to-glmm.html#cb54-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb54-3"><a href="introduction-to-glmm.html#cb54-3"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb54-4"><a href="introduction-to-glmm.html#cb54-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>))</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-23-1.svg" width="672" /></p>
<p>We could also calculate the variance for each genotype × treatment combination and provide a statistical summary of these variances.
This reveals substantial variation among the sample variances on the transformed data. In addition to heterogeneous variances across groups, Figure 1 reveals many zeroes in groups, and some groups with a mean and variance of zero, further suggesting we need a non-normal error distribution, and perhaps something other than a Poisson distribution.</p>
<p>We could calculate λ(mean) for each genotype × treatment combination and provide a statistical summary of each group’s λ.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="introduction-to-glmm.html#cb55-1"></a>grpMeans &lt;-<span class="st"> </span><span class="kw">with</span>(dat_tf, <span class="kw">tapply</span>(total.fruits, <span class="kw">list</span>(gna), mean))</span>
<span id="cb55-2"><a href="introduction-to-glmm.html#cb55-2"></a><span class="kw">summary</span>(grpMeans)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   11.35   23.16   31.86   49.74  122.40</code></pre>
<p>A core property of the Poisson distribution is that the variance is equal to the mean. A simple diagnostic is a plot of the group variances against the group means:</p>
<ul>
<li>Poisson-distributed data will result in a linear pattern with slope = 1</li>
<li>as long as the variance is generally greater than the mean, we call the data overdispersed. Overdispersion comes in various forms:
<ul>
<li>a linear mean-variance relationship with Var = φµ (a line through the origin) with φ &gt; 1 is called a quasi-Poisson pattern (this term describes the mean-variance relationship, not any particular proability distribution); we can implement it statistically via quasilikelihood (Venables and Ripley, 2002) or by using a particular parameterization of the negative binomial distribution (“NB1” inthe terminology of Hardin and Hilbe (2007))</li>
<li>a semi-quadratic pattern, Var = µ(1 + αµ) or µ(1 + µ/k), is characteristic of overdispersed data that is driven by underlying heterogeneity among samples, either the negative binomial (gamma-Poisson) or the lognormal-Poisson (Elston et al., 2001)</li>
</ul></li>
</ul>
<p>We’ve already calculated the group (genotype × treatment) means, we calculate the variances in the same way.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="introduction-to-glmm.html#cb57-1"></a>grpVars &lt;-<span class="st"> </span><span class="kw">with</span>(</span>
<span id="cb57-2"><a href="introduction-to-glmm.html#cb57-2"></a>  dat_tf,</span>
<span id="cb57-3"><a href="introduction-to-glmm.html#cb57-3"></a>  <span class="kw">tapply</span>(</span>
<span id="cb57-4"><a href="introduction-to-glmm.html#cb57-4"></a>    total.fruits,</span>
<span id="cb57-5"><a href="introduction-to-glmm.html#cb57-5"></a>    <span class="kw">list</span>(gna), var</span>
<span id="cb57-6"><a href="introduction-to-glmm.html#cb57-6"></a>  )</span>
<span id="cb57-7"><a href="introduction-to-glmm.html#cb57-7"></a>)</span></code></pre></div>
<p>We can get approximate estimates of the quasi-Poisson (linear) and negative binomial (linear/quadratic) pattern using lm.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="introduction-to-glmm.html#cb58-1"></a>lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(grpVars <span class="op">~</span><span class="st"> </span>grpMeans <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="co">## `quasi-Poisson&#39; fit</span></span>
<span id="cb58-2"><a href="introduction-to-glmm.html#cb58-2"></a>phi.fit &lt;-<span class="st"> </span><span class="kw">coef</span>(lm1)</span>
<span id="cb58-3"><a href="introduction-to-glmm.html#cb58-3"></a>lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>((grpVars <span class="op">-</span><span class="st"> </span>grpMeans) <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(grpMeans<span class="op">^</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb58-4"><a href="introduction-to-glmm.html#cb58-4"></a>k.fit &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(lm2)</span></code></pre></div>
<p>Now we can plot them.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="introduction-to-glmm.html#cb59-1"></a><span class="kw">plot</span>(grpVars <span class="op">~</span><span class="st"> </span>grpMeans, <span class="dt">xlab =</span> <span class="st">&quot;group means&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;group variances&quot;</span>)</span>
<span id="cb59-2"><a href="introduction-to-glmm.html#cb59-2"></a><span class="kw">abline</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb59-3"><a href="introduction-to-glmm.html#cb59-3"></a><span class="kw">text</span>(<span class="dv">105</span>, <span class="dv">500</span>, <span class="st">&quot;Poisson&quot;</span>)</span>
<span id="cb59-4"><a href="introduction-to-glmm.html#cb59-4"></a><span class="kw">curve</span>(phi.fit <span class="op">*</span><span class="st"> </span>x, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb59-5"><a href="introduction-to-glmm.html#cb59-5"></a><span class="co">## bquote() is used to substitute numeric values</span></span>
<span id="cb59-6"><a href="introduction-to-glmm.html#cb59-6"></a><span class="co">## in equations with symbols</span></span>
<span id="cb59-7"><a href="introduction-to-glmm.html#cb59-7"></a><span class="kw">text</span>(<span class="dv">110</span>, <span class="dv">3900</span>,</span>
<span id="cb59-8"><a href="introduction-to-glmm.html#cb59-8"></a>  <span class="kw">bquote</span>(<span class="kw">paste</span>(<span class="st">&quot;QP: &quot;</span>, sigma<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(phi.fit, <span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>mu)),</span>
<span id="cb59-9"><a href="introduction-to-glmm.html#cb59-9"></a>  <span class="dt">col =</span> <span class="dv">2</span></span>
<span id="cb59-10"><a href="introduction-to-glmm.html#cb59-10"></a>)</span>
<span id="cb59-11"><a href="introduction-to-glmm.html#cb59-11"></a><span class="kw">curve</span>(x <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x <span class="op">/</span><span class="st"> </span>k.fit), <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb59-12"><a href="introduction-to-glmm.html#cb59-12"></a><span class="kw">text</span>(<span class="dv">104</span>, <span class="dv">7200</span>, <span class="kw">paste</span>(<span class="st">&quot;NB: k=&quot;</span>, <span class="kw">round</span>(k.fit, <span class="dv">1</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>), <span class="dt">col =</span> <span class="dv">4</span>)</span>
<span id="cb59-13"><a href="introduction-to-glmm.html#cb59-13"></a>Lfit &lt;-<span class="st"> </span><span class="kw">loess</span>(grpVars <span class="op">~</span><span class="st"> </span>grpMeans)</span>
<span id="cb59-14"><a href="introduction-to-glmm.html#cb59-14"></a>mvec &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">120</span></span>
<span id="cb59-15"><a href="introduction-to-glmm.html#cb59-15"></a><span class="kw">lines</span>(mvec, <span class="kw">predict</span>(Lfit, mvec), <span class="dt">col =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-27-1.svg" width="672" /></p>
<p>Same with ggplot</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="introduction-to-glmm.html#cb60-1"></a><span class="kw">ggplot</span>(</span>
<span id="cb60-2"><a href="introduction-to-glmm.html#cb60-2"></a>  <span class="kw">data.frame</span>(grpMeans, grpVars),</span>
<span id="cb60-3"><a href="introduction-to-glmm.html#cb60-3"></a>  <span class="kw">aes</span>(<span class="dt">x =</span> grpMeans, <span class="dt">y =</span> grpVars)</span>
<span id="cb60-4"><a href="introduction-to-glmm.html#cb60-4"></a>) <span class="op">+</span></span>
<span id="cb60-5"><a href="introduction-to-glmm.html#cb60-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb60-6"><a href="introduction-to-glmm.html#cb60-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Loess&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Loess&quot;</span>)) <span class="op">+</span></span>
<span id="cb60-7"><a href="introduction-to-glmm.html#cb60-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Q_Pois&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Q_Pois&quot;</span>)) <span class="op">+</span></span>
<span id="cb60-8"><a href="introduction-to-glmm.html#cb60-8"></a><span class="st">  </span><span class="kw">stat_function</span>(</span>
<span id="cb60-9"><a href="introduction-to-glmm.html#cb60-9"></a>    <span class="dt">fun =</span> <span class="cf">function</span>(x) x <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x <span class="op">/</span><span class="st"> </span>k.fit),</span>
<span id="cb60-10"><a href="introduction-to-glmm.html#cb60-10"></a>    <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;Neg_bin&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Neg_bin&quot;</span>)</span>
<span id="cb60-11"><a href="introduction-to-glmm.html#cb60-11"></a>  ) <span class="op">+</span></span>
<span id="cb60-12"><a href="introduction-to-glmm.html#cb60-12"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="kw">aes</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&quot;Poisson&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Poisson&quot;</span>)) <span class="op">+</span></span>
<span id="cb60-13"><a href="introduction-to-glmm.html#cb60-13"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">name =</span> <span class="st">&quot;legend&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb60-14"><a href="introduction-to-glmm.html#cb60-14"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">&quot;legend&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)) <span class="op">+</span></span>
<span id="cb60-15"><a href="introduction-to-glmm.html#cb60-15"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown aesthetics: fill

## Warning: Ignoring unknown aesthetics: fill</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-28-1.svg" width="672" />
<!-- Todo need to edit the color legend --></p>
<p>These fits are not rigorous statistical tests — they violate a variety of assumptions of linear regression (e.g. constant variance, independence), but they are good enough to give us an initial guess about what distributions we should use.</p>
<p><strong>Exercise</strong></p>
<ul>
<li>compare a simple quadratic fit to the data (i.e., without the linear part) with the negative binomial and quasipoisson fits
<!-- -  Draw a plot to suggest whether one might be able to stabilize the variance of the data by log(1 + x)-transforming the data. --></li>
</ul>
<div id="plotting-the-response-vs-treatments" class="section level4">
<h4><span class="header-section-number">6.1.5.1</span> Plotting the response vs treatments</h4>
<p>Just to avoid surprises</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="introduction-to-glmm.html#cb63-1"></a><span class="kw">ggplot</span>(dat_tf, <span class="kw">aes</span>(<span class="dt">x =</span> amd, <span class="dt">y =</span> <span class="kw">log</span>(total.fruits <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">colour =</span> nutrient)) <span class="op">+</span></span>
<span id="cb63-2"><a href="introduction-to-glmm.html#cb63-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb63-3"><a href="introduction-to-glmm.html#cb63-3"></a><span class="st">  </span><span class="co">## need to use as.numeric(amd) to get lines</span></span>
<span id="cb63-4"><a href="introduction-to-glmm.html#cb63-4"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(amd)), <span class="dt">fun =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span></span>
<span id="cb63-5"><a href="introduction-to-glmm.html#cb63-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb63-6"><a href="introduction-to-glmm.html#cb63-6"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">theme</span>(<span class="dt">panel.margin =</span> <span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;lines&quot;</span>)) <span class="op">+</span></span>
<span id="cb63-7"><a href="introduction-to-glmm.html#cb63-7"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>popu)</span></code></pre></div>
<pre><code>## Warning: `panel.margin` is deprecated. Please use `panel.spacing` property
## instead</code></pre>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-29-1.svg" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="introduction-to-glmm.html#cb65-1"></a><span class="kw">ggplot</span>(dat_tf, <span class="kw">aes</span>(<span class="dt">x =</span> amd, <span class="dt">y =</span> <span class="kw">log</span>(total.fruits <span class="op">+</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">colour =</span> gen)) <span class="op">+</span></span>
<span id="cb65-2"><a href="introduction-to-glmm.html#cb65-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb65-3"><a href="introduction-to-glmm.html#cb65-3"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(amd)), <span class="dt">fun =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="op">+</span></span>
<span id="cb65-4"><a href="introduction-to-glmm.html#cb65-4"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb65-5"><a href="introduction-to-glmm.html#cb65-5"></a><span class="st">  </span><span class="co">## label_both adds variable name (&#39;nutrient&#39;) to facet labels</span></span>
<span id="cb65-6"><a href="introduction-to-glmm.html#cb65-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>nutrient, <span class="dt">labeller =</span> label_both)</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-29-2.svg" width="672" /></p>
</div>
</div>
<div id="fitting-group-wise-glm" class="section level3">
<h3><span class="header-section-number">6.1.6</span> Fitting group-wise GLM</h3>
<p>Another general starting approach is to fit GLMs to each group of data separately, equivalent to treating the grouping variables as fixed effects.
This should result in reasonable variation among treatment effects. We first fit the models, and then examine the coefficients.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="introduction-to-glmm.html#cb66-1"></a>glm.lis &lt;-<span class="st"> </span><span class="kw">lmList</span>(total.fruits <span class="op">~</span><span class="st"> </span>nutrient <span class="op">*</span><span class="st"> </span>amd <span class="op">|</span><span class="st"> </span>gen, <span class="dt">data =</span> dat_tf, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb66-2"><a href="introduction-to-glmm.html#cb66-2"></a><span class="kw">plot.lmList</span>(glm.lis)</span></code></pre></div>
<pre><code>## Using grp as id variables</code></pre>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-30-1.svg" width="672" /></p>
<p><strong>Exercise</strong>
Fit plot to examine output</p>
</div>
<div id="fitting-and-evaluating-glmms" class="section level3">
<h3><span class="header-section-number">6.1.7</span> Fitting and evaluating GLMMs</h3>
<p>Now we (try to) build and fit a full model, using glmer in the lme4 package9 . This model has random effects for all genotype and population × treatment random effects, and for the nuisance variables for the rack and germination method (status). (Given the mean-variance relationship we saw it’s pretty clear that we are going to have to proceed eventually to a model with overdispersion, but we fit the Poisson model first for illustration.)</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="introduction-to-glmm.html#cb68-1"></a>mp1 &lt;-<span class="st"> </span><span class="kw">glmer</span>(total.fruits <span class="op">~</span><span class="st"> </span>nutrient <span class="op">*</span><span class="st"> </span>amd <span class="op">+</span></span>
<span id="cb68-2"><a href="introduction-to-glmm.html#cb68-2"></a><span class="st">  </span>rack <span class="op">+</span><span class="st"> </span>status <span class="op">+</span></span>
<span id="cb68-3"><a href="introduction-to-glmm.html#cb68-3"></a><span class="st">  </span>(amd <span class="op">*</span><span class="st"> </span>nutrient <span class="op">|</span><span class="st"> </span>popu) <span class="op">+</span></span>
<span id="cb68-4"><a href="introduction-to-glmm.html#cb68-4"></a><span class="st">  </span>(amd <span class="op">*</span><span class="st"> </span>nutrient <span class="op">|</span><span class="st"> </span>gen),</span>
<span id="cb68-5"><a href="introduction-to-glmm.html#cb68-5"></a><span class="dt">data =</span> dat_tf, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span></span>
<span id="cb68-6"><a href="introduction-to-glmm.html#cb68-6"></a>)</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.0132432 (tol = 0.002, component 1)</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="introduction-to-glmm.html#cb70-1"></a><span class="kw">overdisp_fun</span>(mp1)</span></code></pre></div>
<pre><code>##       chisq       ratio           p 
## 13909.46562    23.25998     0.00000</code></pre>
<p>We can ignore the model convergence for the moment. This shows that the data are (extremely) over-dispersed, given the model.</p>
<p>Now we add the observation-level random effect to the model to account for overdispersion (Elston et al., 2001):</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="introduction-to-glmm.html#cb72-1"></a>mp2 &lt;-<span class="st"> </span><span class="kw">update</span>(mp1, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>X))</span></code></pre></div>
<pre><code>## Warning in (function (fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, :
## failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in optwrap(optimizer, devfun, start, rho$lower, control = control, :
## convergence code 4 from Nelder_Mead: failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.169728 (tol = 0.002, component 1)</code></pre>
<p>The model takes much longer to fit (and gives warnings).
We look just at the variance components. In particular, if we look at the correlation matrix among the genotype random effects, we see a perfect
correlation.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="introduction-to-glmm.html#cb76-1"></a><span class="kw">attr</span>(<span class="kw">VarCorr</span>(mp2)<span class="op">$</span>gen, <span class="st">&quot;correlation&quot;</span>)</span></code></pre></div>
<pre><code>##                         (Intercept) amdclipped nutrientHigh
## (Intercept)               1.0000000 -0.9991408   -0.9877061
## amdclipped               -0.9991408  1.0000000    0.9916060
## nutrientHigh             -0.9877061  0.9916060    1.0000000
## amdclipped:nutrientHigh   0.8225706 -0.8397183   -0.9012402
##                         amdclipped:nutrientHigh
## (Intercept)                           0.8225706
## amdclipped                           -0.8397183
## nutrientHigh                         -0.9012402
## amdclipped:nutrientHigh               1.0000000</code></pre>
<p>We’ll try getting rid of the correlations between clipping (amd) and nutrients, using amd+nutrient instead of amd*nutrient in the random effects specification (here it seems easier to re-do the model rather than using update to add and subtract terms).</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="introduction-to-glmm.html#cb78-1"></a>mp3 &lt;-<span class="st"> </span><span class="kw">glmer</span>(total.fruits <span class="op">~</span><span class="st"> </span>nutrient <span class="op">*</span><span class="st"> </span>amd <span class="op">+</span></span>
<span id="cb78-2"><a href="introduction-to-glmm.html#cb78-2"></a><span class="st">  </span>rack <span class="op">+</span><span class="st"> </span>status <span class="op">+</span></span>
<span id="cb78-3"><a href="introduction-to-glmm.html#cb78-3"></a><span class="st">  </span>(amd <span class="op">+</span><span class="st"> </span>nutrient <span class="op">|</span><span class="st"> </span>popu) <span class="op">+</span></span>
<span id="cb78-4"><a href="introduction-to-glmm.html#cb78-4"></a><span class="st">  </span>(amd <span class="op">+</span><span class="st"> </span>nutrient <span class="op">|</span><span class="st"> </span>gen) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>X),</span>
<span id="cb78-5"><a href="introduction-to-glmm.html#cb78-5"></a><span class="dt">data =</span> dat_tf, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span></span>
<span id="cb78-6"><a href="introduction-to-glmm.html#cb78-6"></a>)</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.17819 (tol = 0.002, component 1)</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="introduction-to-glmm.html#cb80-1"></a><span class="kw">attr</span>(<span class="kw">VarCorr</span>(mp3)<span class="op">$</span>gen, <span class="st">&quot;correlation&quot;</span>)</span></code></pre></div>
<pre><code>##              (Intercept) amdclipped nutrientHigh
## (Intercept)    1.0000000 -0.7762341   -0.9979863
## amdclipped    -0.7762341  1.0000000    0.7743002
## nutrientHigh  -0.9979863  0.7743002    1.0000000</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="introduction-to-glmm.html#cb82-1"></a><span class="kw">attr</span>(<span class="kw">VarCorr</span>(mp3)<span class="op">$</span>popu, <span class="st">&quot;correlation&quot;</span>)</span></code></pre></div>
<pre><code>##              (Intercept) amdclipped nutrientHigh
## (Intercept)    1.0000000  0.9995678    0.9973568
## amdclipped     0.9995678  1.0000000    0.9961872
## nutrientHigh   0.9973568  0.9961872    1.0000000</code></pre>
<p>Unfortunately, we still have perfect correlations among the random effects terms. For some models (e.g. random-slope models), it is possible to fit random effects models in such a way that the correlation between the different parameters (intercept and slope in the case of random-slope models) is constrained to be zero, by fitting a model like (1|f)+(0+x|f); unfortunately, because of the way lme4 is set up, this is considerably more difficult with categorical predictors (factors).</p>
<p>We have to reduce the model further in some way in order not to overfit (i.e., in order to not have perfect ±1 correlations among random effects). It looks like we can’t allow both nutrients and clipping in the random effect model at either the population or the genotype level. However, it’s hard to know whether we should proceed with amd or nutrient, both, or neither in the model.</p>
<p>A convenient way to proceed if we are going to try fitting several different combinations of random effects is to fit the model with all the fixed effects but only observation-level random effects, and then to use update to add various components to it.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="introduction-to-glmm.html#cb84-1"></a>mp_obs &lt;-<span class="st"> </span><span class="kw">glmer</span>(total.fruits <span class="op">~</span><span class="st"> </span>nutrient <span class="op">*</span><span class="st"> </span>amd <span class="op">+</span></span>
<span id="cb84-2"><a href="introduction-to-glmm.html#cb84-2"></a><span class="st">  </span>rack <span class="op">+</span><span class="st"> </span>status <span class="op">+</span></span>
<span id="cb84-3"><a href="introduction-to-glmm.html#cb84-3"></a><span class="st">  </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>X),</span>
<span id="cb84-4"><a href="introduction-to-glmm.html#cb84-4"></a><span class="dt">data =</span> dat_tf, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span></span>
<span id="cb84-5"><a href="introduction-to-glmm.html#cb84-5"></a>)</span></code></pre></div>
<p>Now, for example, <code>update(mp_obs,.~.+(1|gen)+(amd|popu))</code> fits the model with intercept random effects at the genotype level and variation in clipping effects across populations.</p>
<p><strong>Exercise</strong> using update, fit the models with (1) clipping variation at both genotype and population levels; (2) nutrient variation at both genotype and populations; using printvc, convince yourself that trying to fit variation in either clipping or nutrients leads to overfitting (perfect correlations). Fit the model with only intercept variation at the population and genotype levels, saving it as mp4; show that there is non-zero variance estimated</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="introduction-to-glmm.html#cb85-1"></a>mp4 &lt;-<span class="st"> </span><span class="kw">update</span>(mp_obs, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>gen) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>popu))</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.0256392 (tol = 0.002, component 1)</code></pre>
<p>In other words, while it’s biologically plausible that there is some variation in the nutrient or clipping effect at the genotype or population levels,
with this modeling approach we really don’t have enough data to speak
confidently about these effects.
Let’s check that mp4 no longer incorporates overdispersion (the observationlevel random effect should have taken care of it):</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="introduction-to-glmm.html#cb87-1"></a><span class="kw">overdisp_fun</span>(mp4)</span></code></pre></div>
<pre><code>##       chisq       ratio           p 
## 177.3529154   0.2883787   1.0000000</code></pre>
</div>
<div id="inference" class="section level3">
<h3><span class="header-section-number">6.1.8</span> Inference</h3>
<div id="random-effects" class="section level4">
<h4><span class="header-section-number">6.1.8.1</span> Random effects</h4>
<p><code>glmer</code> (<code>lmer</code>) does not return information about the standard errors or confidence intervals of the variance components.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="introduction-to-glmm.html#cb89-1"></a><span class="kw">VarCorr</span>(mp4)</span></code></pre></div>
<pre><code>##  Groups Name        Std.Dev.
##  X      (Intercept) 1.43206 
##  gen    (Intercept) 0.28728 
##  popu   (Intercept) 0.80614</code></pre>
<div id="testing-for-random-effects" class="section level5">
<h5><span class="header-section-number">6.1.8.1.1</span> Testing for random Effects</h5>
<p>If we want to test the significance of the random effects we can fit reduced models and run likelihood ratio tests via anova, keeping in mind that in this case (testing a null hypothesis of zero variance, where the parameter is on the boundary of its feasible region) the reported p value is approximately 21twice what it should be.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="introduction-to-glmm.html#cb91-1"></a>mp4v1 &lt;-<span class="st"> </span><span class="kw">update</span>(mp_obs, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>popu)) <span class="co">## popu only (drop gen)</span></span>
<span id="cb91-2"><a href="introduction-to-glmm.html#cb91-2"></a>mp4v2 &lt;-<span class="st"> </span><span class="kw">update</span>(mp_obs, . <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>gen)) <span class="co">## gen only (drop popu)</span></span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## unable to evaluate scaled gradient</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge: degenerate Hessian with 2 negative eigenvalues</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="introduction-to-glmm.html#cb94-1"></a><span class="kw">anova</span>(mp4, mp4v1)</span></code></pre></div>
<pre><code>## Data: dat_tf
## Models:
## mp4v1: total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
## mp4v1:     popu) + nutrient:amd
## mp4: total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
## mp4:     gen) + (1 | popu) + nutrient:amd
##       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
## mp4v1    9 5017.4 5057.4 -2499.7   4999.4                       
## mp4     10 5015.4 5059.8 -2497.7   4995.4 4.0627  1    0.04384 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="introduction-to-glmm.html#cb96-1"></a><span class="kw">anova</span>(mp4, mp4v2)</span></code></pre></div>
<pre><code>## Data: dat_tf
## Models:
## mp4v2: total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
## mp4v2:     gen) + nutrient:amd
## mp4: total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
## mp4:     gen) + (1 | popu) + nutrient:amd
##       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
## mp4v2    9 5031.6 5071.5 -2506.8   5013.6                         
## mp4     10 5015.4 5059.8 -2497.7   4995.4 18.211  1  1.977e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>For various forms of linear mixed models, the RLRsim package can do efficient simulation-based hypothesis testing of variance components — un- fortunately, that doesn’t include GLMMs. If we are sufficiently patient we can do hypothesis testing via brute-force parametric bootstrapping where we repeatedly simulate data from the reduced (null) model, fit both the re- duced and full models to the simulated data, and compute the distribution of the deviance (change in -2 log likelihood). The code below took about half an hour on a reasonably modern desktop computer.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="introduction-to-glmm.html#cb98-1"></a>simdev &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb98-2"><a href="introduction-to-glmm.html#cb98-2"></a>  newdat &lt;-<span class="st"> </span><span class="kw">simulate</span>(mp4v1)</span>
<span id="cb98-3"><a href="introduction-to-glmm.html#cb98-3"></a>  reduced &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">refit</span>(mp4v1, newdat)</span>
<span id="cb98-4"><a href="introduction-to-glmm.html#cb98-4"></a>  full &lt;-<span class="st"> </span>lme4<span class="op">::</span><span class="kw">refit</span>(mp4, newdat)</span>
<span id="cb98-5"><a href="introduction-to-glmm.html#cb98-5"></a>  <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">c</span>(<span class="kw">logLik</span>(full) <span class="op">-</span><span class="st"> </span><span class="kw">logLik</span>(reduced)))</span>
<span id="cb98-6"><a href="introduction-to-glmm.html#cb98-6"></a>}</span>
<span id="cb98-7"><a href="introduction-to-glmm.html#cb98-7"></a></span>
<span id="cb98-8"><a href="introduction-to-glmm.html#cb98-8"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb98-9"><a href="introduction-to-glmm.html#cb98-9"></a><span class="co">## raply in plyr is a convenient wrapper for repeating the simulation many times</span></span>
<span id="cb98-10"><a href="introduction-to-glmm.html#cb98-10"></a>nulldist &lt;-<span class="st"> </span><span class="kw">raply</span>(<span class="dv">200</span>, <span class="kw">simdev</span>(), <span class="dt">.progress =</span> <span class="st">&quot;text&quot;</span>)</span></code></pre></div>
<pre><code>## 
  |                                                                                                                                                     
  |                                                                                                                                               |   0%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.7556 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.810058 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=                                                                                                                                              |   0%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.451749 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=                                                                                                                                              |   1%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0282234 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.413309 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==                                                                                                                                             |   2%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0419314 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===                                                                                                                                            |   2%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0129806 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0218993 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====                                                                                                                                           |   2%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.460521 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0073801 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====                                                                                                                                           |   3%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0405431 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.137902 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====                                                                                                                                          |   4%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.132241 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.374146 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======                                                                                                                                         |   4%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0594283 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.212724 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0114391 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.734791 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======                                                                                                                                        |   5%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.104184 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0966132 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========                                                                                                                                       |   6%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.220536 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 2.93869 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========                                                                                                                                      |   6%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.130841 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.27045 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.144001 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.211859 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========                                                                                                                                     |   7%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.342551 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.331113 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========                                                                                                                                    |   8%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.219698 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.353804 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00562547 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0780618 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============                                                                                                                                   |   8%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.117214 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.248659 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============                                                                                                                                  |   9%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0214397 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.25038 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============                                                                                                                                 |  10%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.103164 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0181526 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00484483 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.135102 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============                                                                                                                                |  10%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0220156 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================                                                                                                                               |  11%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.56626 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.138497 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================                                                                                                                               |  12%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.132495 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 2.17148 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================                                                                                                                              |  12%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.235796 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.587962 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================                                                                                                                             |  12%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00878595 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.136601 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================                                                                                                                            |  13%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0248401 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.51539 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================                                                                                                                            |  14%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0961619 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================                                                                                                                           |  14%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.153501 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================                                                                                                                          |  14%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.234756 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.974136 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================                                                                                                                          |  15%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.185619 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : unable to evaluate scaled gradient</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge: degenerate Hessian with 1 negative eigenvalues</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================                                                                                                                         |  16%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0162333 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.220893 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================                                                                                                                        |  16%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.031406 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================                                                                                                                       |  16%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.509306 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================                                                                                                                       |  17%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.066676 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================                                                                                                                      |  18%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.146609 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0599613 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================                                                                                                                     |  18%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.692781 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.577471 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0418376 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.887461 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================                                                                                                                    |  19%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.13065 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================                                                                                                                   |  20%</code></pre>
<pre><code>## Warning in (function (fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, : failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in optwrap(optimizer, ff, x0, lower = lower, control = control$optCtrl, : convergence code 4 from Nelder_Mead: failure to converge in 10000
## evaluations</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.885801 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.137843 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================                                                                                                                  |  20%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.409198 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0710275 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00540515 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.789864 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============================                                                                                                                 |  21%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0333372 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0367826 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================                                                                                                                |  22%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.140922 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in (function (fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, : failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in optwrap(optimizer, ff, x0, lower = lower, control = control$optCtrl, : convergence code 4 from Nelder_Mead: failure to converge in 10000
## evaluations</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.673784 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.252079 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================                                                                                                               |  22%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.256829 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================================                                                                                                              |  23%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.20576 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================                                                                                                             |  24%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00218772 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0434502 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.316396 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.242897 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================                                                                                                            |  24%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0138891 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0967494 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================                                                                                                           |  25%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.269674 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.311533 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================                                                                                                           |  26%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.229954 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0256753 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================================                                                                                                          |  26%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0979751 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.155956 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================                                                                                                         |  26%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.427982 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================                                                                                                        |  27%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.15553 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00239309 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================                                                                                                        |  28%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0478786 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.148502 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================                                                                                                       |  28%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.559 (tol = 0.002, component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================                                                                                                      |  28%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00823181 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.515933 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================                                                                                                      |  29%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0753582 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0542669 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================                                                                                                     |  30%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.112985 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.58244 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================                                                                                                    |  30%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.111527 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0290427 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================                                                                                                   |  30%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.600439 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================                                                                                                   |  31%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0414297 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.337882 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================                                                                                                  |  32%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.828296 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============================================                                                                                                 |  32%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0538109 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.5862 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.05966 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.181536 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================                                                                                                |  33%</code></pre>
<pre><code>## Warning in (function (fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, : failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in optwrap(optimizer, ff, x0, lower = lower, control = control$optCtrl, : convergence code 4 from Nelder_Mead: failure to converge in 10000
## evaluations</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0405631 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.646128 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================================                                                                                               |  34%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.294387 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.779126 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================================================                                                                                              |  34%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0107089 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.70332 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================================                                                                                             |  35%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.078011 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================================                                                                                            |  36%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0286679 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00672112 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.216417 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0253434 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================================                                                                                           |  36%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0193428 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================================================                                                                                          |  37%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.105328 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.428442 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================================                                                                                         |  38%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.16693 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0542704 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.096785 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================                                                                                        |  38%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.021327 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.19529 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================                                                                                       |  39%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.490315 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.396896 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================                                                                                       |  40%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.358307 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================================                                                                                      |  40%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0131502 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.444894 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================================                                                                                     |  40%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0724558 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================                                                                                    |  41%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0391071 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0994033 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================                                                                                    |  42%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0149177 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.16307 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================                                                                                   |  42%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.226157 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0717432 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================================                                                                                  |  42%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0308567 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.87052 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================================                                                                                  |  43%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.541745 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============================================================                                                                                 |  44%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.220962 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================                                                                                |  44%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.199326 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.211691 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================================================                                                                               |  44%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0405407 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================================================                                                                               |  45%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.280303 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================================================================                                                                              |  46%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.982479 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================================================                                                                             |  46%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0664527 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.163193 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.524829 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 2.51527 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================================================                                                                            |  47%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.12643 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.143042 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================================================                                                                           |  48%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.295823 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.179654 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================================================================                                                                          |  48%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00617263 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.753955 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00295593 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.129637 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================================================                                                                         |  49%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.311209 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0110771 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================================                                                                        |  50%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.381269 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.54396 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================================                                                                       |  50%</code></pre>
<pre><code>## Warning in (function (fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, : failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in optwrap(optimizer, ff, x0, lower = lower, control = control$optCtrl, : convergence code 4 from Nelder_Mead: failure to converge in 10000
## evaluations</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.948307 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.92388 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0244203 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.130314 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================================================                                                                      |  51%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0848748 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0149663 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================================================                                                                     |  52%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0033154 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.621124 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00964612 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.460215 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================================                                                                    |  52%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.080336 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.258203 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================                                                                   |  53%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0218762 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================================================                                                                  |  54%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.259641 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.193146 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.527872 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.4826 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============================================================================                                                                 |  54%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00334518 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================================                                                                |  55%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0384966 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : unable to evaluate scaled gradient</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge: degenerate Hessian with 1 negative eigenvalues</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================================                                                                |  56%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0610783 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00792913 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================================================================                                                               |  56%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : unable to evaluate scaled gradient</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge: degenerate Hessian with 1 negative eigenvalues</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.113706 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================================================================================                                                              |  56%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : unable to evaluate scaled gradient</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge: degenerate Hessian with 1 negative eigenvalues</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================================================================                                                             |  57%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0228987 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.129402 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================================================================                                                             |  58%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00934862 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.129978 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================================================================                                                            |  58%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0332541 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================================================================                                                           |  58%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.610386 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.29172 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================================================================                                                           |  59%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.171483 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================================================================================                                                          |  60%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.566862 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================================================================                                                         |  60%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.213042 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================================================                                                        |  60%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.299575 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.214493 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================================================                                                        |  61%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.110702 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.13332 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================================================                                                       |  62%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.3253 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================================================================                                                      |  62%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.100535 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.20945 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================================================================                                                     |  63%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.65422 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================================================                                                    |  64%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 2.0513 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.614007 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================================                                                   |  64%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.104389 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.369273 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0221109 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.205599 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================================================================                                                  |  65%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0191838 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.348407 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============================================================================================                                                 |  66%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.393544 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.19498 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.717014 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.391175 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================================================                                                |  66%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0103886 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.432057 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================================================================================                                               |  67%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.22808 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.133047 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================================================================================================                                              |  68%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.268498 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.180648 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================================================================================                                             |  68%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.32922 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0917915 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================================================================================                                            |  69%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.119318 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.12318 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================================================================================                                            |  70%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.88821 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================================================================================                                           |  70%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.394058 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.354041 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================================================================================================                                          |  70%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.345471 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================================================================================                                         |  71%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00844274 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================================================================================                                         |  72%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.32058 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.417633 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================================================================                                        |  72%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0333355 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.113247 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================================================================                                       |  72%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0401689 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================================================================                                       |  73%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00228972 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0487274 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================================================================================                                      |  74%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0201462 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.035668 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================================================================================                                     |  74%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0415242 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.555456 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================================================================                                    |  74%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.431196 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================================================================                                    |  75%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0742817 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================================================                                   |  76%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.33262 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.03555 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================================================================================                                  |  76%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00393269 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0468253 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0132412 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0062438 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============================================================================================================                                 |  77%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : unable to evaluate scaled gradient</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge: degenerate Hessian with 1 negative eigenvalues</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================================================================                                |  78%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0212909 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0618375 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================================================================================================                               |  78%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0959564 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 1.41885 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.268032 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0960886 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================================================================================================================                              |  79%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0216668 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================================================================================================                             |  80%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00353442 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.102759 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.452087 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================================================================================================                            |  80%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0160519 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.645868 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================================================================================================                           |  81%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00897846 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.354067 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================================================================================================================                          |  82%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00466945 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.442971 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.178143 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================================================================================================                         |  82%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0953678 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================================================================================                        |  83%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0556296 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00364309 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================================================================================                        |  84%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.430109 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================================================================================                       |  84%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.109183 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.291523 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================================================================================================                      |  84%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0646216 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0984943 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================================================================================================                     |  85%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.458411 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0811071 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================================================================================================                     |  86%</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================================================================================                    |  86%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.248034 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================================================================                   |  86%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00572994 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0632514 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================================================================                   |  87%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.47203 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0854961 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================================================================================================                  |  88%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.608698 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==============================================================================================================================                 |  88%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00322449 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.641312 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================================================================================                |  88%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0381292 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.82816 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================================================================================                |  89%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0655928 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0163801 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |================================================================================================================================               |  90%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.171853 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=================================================================================================================================              |  90%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00289973 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.290861 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0514243 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==================================================================================================================================             |  91%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.977261 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.637568 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===================================================================================================================================            |  92%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0505873 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.022695 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |====================================================================================================================================           |  92%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0682568 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00258348 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.566586 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.183774 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=====================================================================================================================================          |  93%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.311476 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.657999 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |======================================================================================================================================         |  94%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.709333 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00474888 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0642709 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=======================================================================================================================================        |  94%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0191696 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.860329 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |========================================================================================================================================       |  95%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.269953 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.204527 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=========================================================================================================================================      |  96%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.106076 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.450121 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0236292 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0126975 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |==========================================================================================================================================     |  96%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.16293 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.164956 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================================================================================================    |  97%</code></pre>
<pre><code>## Warning in (function (fn, par, lower = rep.int(-Inf, n), upper = rep.int(Inf, : failure to converge in 10000 evaluations</code></pre>
<pre><code>## Warning in optwrap(optimizer, ff, x0, lower = lower, control = control$optCtrl, : convergence code 4 from Nelder_Mead: failure to converge in 10000
## evaluations</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.325226 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0162822 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===========================================================================================================================================    |  98%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0407316 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.444971 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================================================================================   |  98%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0849186 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.337252 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |=============================================================================================================================================  |  98%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.123895 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================================================================================== |  99%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.00692264 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.182217 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |============================================================================================================================================== | 100%</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.0644509 (tol = 0.002,
## component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model failed to converge with max|grad| = 0.794661 (tol = 0.002, component
## 1)</code></pre>
<pre><code>## 
  |                                                                                                                                                     
  |===============================================================================================================================================| 100%</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="introduction-to-glmm.html#cb631-1"></a><span class="co">## zero spurious (small) negative values</span></span>
<span id="cb631-2"><a href="introduction-to-glmm.html#cb631-2"></a>nulldist[nulldist <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(nulldist) <span class="op">&lt;</span><span class="st"> </span><span class="fl">1e-5</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb631-3"><a href="introduction-to-glmm.html#cb631-3"></a>obsdev &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">logLik</span>(mp4) <span class="op">-</span><span class="st"> </span><span class="kw">logLik</span>(mp4v1))</span></code></pre></div>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="introduction-to-glmm.html#cb632-1"></a><span class="kw">mean</span>(<span class="kw">c</span>(nulldist, obsdev) <span class="op">&gt;=</span><span class="st"> </span>obsdev)</span></code></pre></div>
<pre><code>## [1] 0.01492537</code></pre>
<p>The true p-value is actually closer to 0.05 than 0.02. In other words, here the deviations from the original statistical model from that for which the original “p value is inflated by 2” rule of thumb was derived — fitting a GLMM instead of a LMM, and using a moderate-sized rather than an arbitrarily large (asymptotic) data set — have made the likelihood ratio test liberal (increased type I error) rather than conservative (decreased type I error).</p>
<p>We can also inspect the random effects estimates themselves (in proper statistical jargon, these might be considered “predictions” rather than “estimates” (Robinson, 1991)). We use the built-in dotplot method for the random effects extracted from glmer fits (i.e. ranef(model,condVar=TRUE)), which returns a list of plots, one for each random effect level in the model.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="introduction-to-glmm.html#cb634-1"></a><span class="kw">library</span>(lattice)</span>
<span id="cb634-2"><a href="introduction-to-glmm.html#cb634-2"></a>pp &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb634-3"><a href="introduction-to-glmm.html#cb634-3"></a>  <span class="dt">layout.widths =</span> <span class="kw">list</span>(<span class="dt">left.padding =</span> <span class="dv">0</span>, <span class="dt">right.padding =</span> <span class="dv">0</span>),</span>
<span id="cb634-4"><a href="introduction-to-glmm.html#cb634-4"></a>  <span class="dt">layout.heights =</span> <span class="kw">list</span>(<span class="dt">top.padding =</span> <span class="dv">0</span>, <span class="dt">bottom.padding =</span> <span class="dv">0</span>)</span>
<span id="cb634-5"><a href="introduction-to-glmm.html#cb634-5"></a>)</span>
<span id="cb634-6"><a href="introduction-to-glmm.html#cb634-6"></a>r1 &lt;-<span class="st"> </span><span class="kw">ranef</span>(mp4, <span class="dt">condVar =</span> <span class="ot">TRUE</span>)</span>
<span id="cb634-7"><a href="introduction-to-glmm.html#cb634-7"></a>d1 &lt;-<span class="st"> </span>lattice<span class="op">::</span><span class="kw">dotplot</span>(r1, <span class="dt">par.settings =</span> pp)</span>
<span id="cb634-8"><a href="introduction-to-glmm.html#cb634-8"></a><span class="kw">print</span>(<span class="kw">grid.arrange</span>(d1<span class="op">$</span>gen, d1<span class="op">$</span>popu, <span class="dt">nrow =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-41-1.svg" width="672" /></p>
<pre><code>## TableGrob (1 x 2) &quot;arrange&quot;: 2 grobs
##   z     cells    name                       grob
## 1 1 (1-1,1-1) arrange lattice[GRID.lattice.2121]
## 2 2 (1-1,2-2) arrange lattice[GRID.lattice.2122]</code></pre>
<p>As expected from the similarity of the variance estimates, the population- level estimates (the only shared component) do not differ much between the two models. There is a hint of regional differentiation — the Spanish populations have higher fruit sets than the Swedish and Dutch populations. Genotype 34 again looks a little bit unusual.</p>
</div>
</div>
<div id="fixed-effects" class="section level4">
<h4><span class="header-section-number">6.1.8.2</span> Fixed effects</h4>
<p>Now we want to do inference on the fixed effects. We use the drop1 func- tion to assess both the AIC difference and the likelihood ratio test between models. (In glmm_funs.R we define a convenience function dfun to con- vert the AIC tables returned by drop1 (which we will create momentarily) into ∆AIC tables.) Although the likelihood ratio test (and the AIC) are asymptotic tests, comparing fits between full and reduced models is still more accurate than the Wald (curvature-based) tests shown in the summary tables for glmer fits.</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="introduction-to-glmm.html#cb636-1"></a>(dd_AIC &lt;-<span class="st"> </span><span class="kw">dfun</span>(<span class="kw">drop1</span>(mp4)))</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.00763683 (tol = 0.002, component 1)</code></pre>
<pre><code>## Single term deletions
## 
## Model:
## total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
##     gen) + (1 | popu) + nutrient:amd
##              npar   dAIC
## &lt;none&gt;             0.000
## rack            1 55.081
## status          2  1.611
## nutrient:amd    1  1.443</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="introduction-to-glmm.html#cb639-1"></a>(dd_LRT &lt;-<span class="st"> </span><span class="kw">drop1</span>(mp4, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>))</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.00763683 (tol = 0.002, component 1)</code></pre>
<pre><code>## Single term deletions
## 
## Model:
## total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
##     gen) + (1 | popu) + nutrient:amd
##              npar    AIC    LRT   Pr(Chi)    
## &lt;none&gt;            5015.4                     
## rack            1 5070.5 57.081 4.182e-14 ***
## status          2 5017.0  5.611   0.06047 .  
## nutrient:amd    1 5016.8  3.443   0.06353 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>On the basis of these comparisons, there appears to be a very strong effect of rack and weak effects of status and of the interaction term. Dropping the nutrient:amd interaction gives a (slightly) increased AIC (∆AIC = 1.4), so the full model has the best expected predictive capability (by a small margin). On the other hand, the p-value is slightly above 0.05 (p = 0.06). At this point we remove the non-significant interaction term so we can test the main effects. (We don’t worry about removing status because it measures an aspect of experimental design that we want to leave in the model whether it is significant or not.) Once we have fitted the reduced model, we can run the LRT via anova.</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="introduction-to-glmm.html#cb642-1"></a>mp5 &lt;-<span class="st"> </span><span class="kw">update</span>(mp4, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>amd<span class="op">:</span>nutrient)</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.00763683 (tol = 0.002, component 1)</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="introduction-to-glmm.html#cb644-1"></a><span class="kw">anova</span>(mp5, mp4)</span></code></pre></div>
<pre><code>## Data: dat_tf
## Models:
## mp5: total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
## mp5:     gen) + (1 | popu)
## mp4: total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | 
## mp4:     gen) + (1 | popu) + nutrient:amd
##     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
## mp5    9 5016.8 5056.8 -2499.4   4998.8                       
## mp4   10 5015.4 5059.8 -2497.7   4995.4 3.4427  1    0.06353 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Exercise</strong>
Test now the reduced model.</p>
<p>In the reduced model, we find that both nutrients and clipping have strong effects, whether measured by AIC or LRT. If we wanted to be still more careful about our interpretation, we would try to relax the asymptotic assumption. In classical linear models, we would do this by doing F tests with the appropriate denominator degrees of freedom. In “modern” mixed model approaches, we might try to use denominator-degree-of-freedom approximations such as the Kenward-Roger (despite the controversy over these approximations, they are actually available in <code>lmerTest</code>, but they do not apply to GLMMs. We can use a parametric bootstrap comparison between nested models to test fixed effects, as we did above for random effects, with the caveat that is computationally slow.</p>
<p>In addition, we can check the normality of the random effects and find they are reasonable (Fig. 10). We use ldply from the reshape package to collapse the list of random effect values into a data frame (we might have to do something different if there were more than one random effect within each level, e.g. a model including (nutrient|gen)). The fancy panel code in the figure adds a reference line to the Q-Q plot.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="introduction-to-glmm.html#cb646-1"></a>reStack &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">ldply</span>(<span class="kw">ranef</span>(mp5))</span>
<span id="cb646-2"><a href="introduction-to-glmm.html#cb646-2"></a><span class="kw">print</span>(<span class="kw">qqmath</span>(<span class="op">~</span><span class="st"> `</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">|</span><span class="st"> </span>.id,</span>
<span id="cb646-3"><a href="introduction-to-glmm.html#cb646-3"></a>  <span class="dt">data =</span> reStack, <span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">relation =</span> <span class="st">&quot;free&quot;</span>),</span>
<span id="cb646-4"><a href="introduction-to-glmm.html#cb646-4"></a>  <span class="dt">prepanel =</span> prepanel.qqmathline,</span>
<span id="cb646-5"><a href="introduction-to-glmm.html#cb646-5"></a>  <span class="dt">panel =</span> <span class="cf">function</span>(x, ...) {</span>
<span id="cb646-6"><a href="introduction-to-glmm.html#cb646-6"></a>    <span class="kw">panel.qqmathline</span>(x, ...)</span>
<span id="cb646-7"><a href="introduction-to-glmm.html#cb646-7"></a>    <span class="kw">panel.qqmath</span>(x, ...)</span>
<span id="cb646-8"><a href="introduction-to-glmm.html#cb646-8"></a>  },</span>
<span id="cb646-9"><a href="introduction-to-glmm.html#cb646-9"></a>  <span class="dt">layout =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb646-10"><a href="introduction-to-glmm.html#cb646-10"></a>))</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-44-1.svg" width="672" /></p>
</div>
</div>
</div>
</div>
<script src="js/solution.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-linear-mixed-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/BIO8940-uOttawa/class_book/02_03-intro_glmm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BIO8940_book.pdf", "BIO8940_book.epub", "BIO8940_book.mobi"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
