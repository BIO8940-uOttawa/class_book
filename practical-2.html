<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.1 Practical | BIO8940 Advanced stats and Open Science</title>
  <meta name="description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5.1 Practical | BIO8940 Advanced stats and Open Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/missing.png" />
  <meta property="og:description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="github-repo" content="BIO8940-uOttawa/class_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.1 Practical | BIO8940 Advanced stats and Open Science" />
  
  <meta name="twitter:description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="twitter:image" content="images/missing.png" />

<meta name="author" content="Julien Martin" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="refresher-on-glm-1.html"/>
<link rel="next" href="refresher-on-glm-2.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIO8940 class manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Note</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="" data-path="quelques-points-importants-à-retenir.html"><a href="quelques-points-importants-à-retenir.html"><i class="fa fa-check"></i>Quelques points importants à retenir</a></li>
<li class="chapter" data-level="" data-path="quest-ce-que-r-et-pourquoi-lutiliser-dans-ce-cours.html"><a href="quest-ce-que-r-et-pourquoi-lutiliser-dans-ce-cours.html"><i class="fa fa-check"></i>Qu’est-ce que R et pourquoi l’utiliser dans ce cours?</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html"><i class="fa fa-check"></i>Installation des logiciels nécessaires</a><ul>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="0.0.1" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#text-editor-or-ide"><i class="fa fa-check"></i><b>0.0.1</b> Text editor or IDE</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#paquets-pour-r"><i class="fa fa-check"></i>Paquets pour R</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#pandoc"><i class="fa fa-check"></i>pandoc</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#latex"><i class="fa fa-check"></i>laTex</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="instructions-générales-pour-les-laboratoires.html"><a href="instructions-générales-pour-les-laboratoires.html"><i class="fa fa-check"></i>Instructions générales pour les laboratoires</a></li>
<li class="chapter" data-level="" data-path="notes-sur-le-manuel.html"><a href="notes-sur-le-manuel.html"><i class="fa fa-check"></i>Notes sur le manuel</a><ul>
<li class="chapter" data-level="" data-path="notes-sur-le-manuel.html"><a href="notes-sur-le-manuel.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="notes-sur-le-manuel.html"><a href="notes-sur-le-manuel.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Open Science</b></span></li>
<li class="chapter" data-level="1" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html"><i class="fa fa-check"></i><b>1</b> Introduction to open Science</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-rmarkdown.html"><a href="introduction-to-rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduction to Rmarkdown</a><ul>
<li class="chapter" data-level="2.1" data-path="practical.html"><a href="practical.html"><i class="fa fa-check"></i><b>2.1</b> Practical</a><ul>
<li class="chapter" data-level="2.1.1" data-path="practical.html"><a href="practical.html#context"><i class="fa fa-check"></i><b>2.1.1</b> Context</a></li>
<li class="chapter" data-level="2.1.2" data-path="practical.html"><a href="practical.html#questions"><i class="fa fa-check"></i><b>2.1.2</b> Questions</a></li>
<li class="chapter" data-level="2.1.3" data-path="practical.html"><a href="practical.html#happy-coding"><i class="fa fa-check"></i><b>2.1.3</b> Happy coding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-github-with-r.html"><a href="introduction-to-github-with-r.html"><i class="fa fa-check"></i><b>3</b> Introduction to github with R</a><ul>
<li class="chapter" data-level="3.1" data-path="practical-1.html"><a href="practical-1.html"><i class="fa fa-check"></i><b>3.1</b> Practical</a><ul>
<li class="chapter" data-level="3.1.1" data-path="practical-1.html"><a href="practical-1.html#context-1"><i class="fa fa-check"></i><b>3.1.1</b> Context</a></li>
<li class="chapter" data-level="3.1.2" data-path="practical-1.html"><a href="practical-1.html#information-of-the-data"><i class="fa fa-check"></i><b>3.1.2</b> Information of the data</a></li>
<li class="chapter" data-level="3.1.3" data-path="practical-1.html"><a href="practical-1.html#questions-1"><i class="fa fa-check"></i><b>3.1.3</b> Questions</a></li>
<li class="chapter" data-level="3.1.4" data-path="practical-1.html"><a href="practical-1.html#happy-github-ing"><i class="fa fa-check"></i><b>3.1.4</b> Happy git(hub)-ing</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Statistics</b></span></li>
<li class="chapter" data-level="4" data-path="refresher-on-glm.html"><a href="refresher-on-glm.html"><i class="fa fa-check"></i><b>4</b> Refresher on <code>glm</code></a></li>
<li class="chapter" data-level="5" data-path="refresher-on-glm-1.html"><a href="refresher-on-glm-1.html"><i class="fa fa-check"></i><b>5</b> Refresher on <code>glm</code></a><ul>
<li class="chapter" data-level="5.1" data-path="practical-2.html"><a href="practical-2.html"><i class="fa fa-check"></i><b>5.1</b> Practical</a><ul>
<li class="chapter" data-level="5.1.1" data-path="practical-2.html"><a href="practical-2.html#the-superb-wild-unicorns-of-the-scottish-highlands"><i class="fa fa-check"></i><b>5.1.1</b> The superb wild unicorns of the Scottish Highlands</a></li>
<li class="chapter" data-level="5.1.2" data-path="practical-2.html"><a href="practical-2.html#questions-2"><i class="fa fa-check"></i><b>5.1.2</b> Questions</a></li>
<li class="chapter" data-level="5.1.3" data-path="practical-2.html"><a href="practical-2.html#happy-mixed-modelling"><i class="fa fa-check"></i><b>5.1.3</b> Happy mixed-modelling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="refresher-on-glm-2.html"><a href="refresher-on-glm-2.html"><i class="fa fa-check"></i><b>6</b> Refresher on <code>glm</code></a></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="" data-path="r-1.html"><a href="r-1.html"><i class="fa fa-check"></i>R</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIO8940 Advanced stats and Open Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practical-2" class="section level2">
<h2><span class="header-section-number">5.1</span> Practical</h2>
<div id="the-superb-wild-unicorns-of-the-scottish-highlands" class="section level3">
<h3><span class="header-section-number">5.1.1</span> The superb wild unicorns of the Scottish Highlands</h3>
<p>Unicorns, a legendary animal and also symbol or Scotland, are frequently described as extremely wild woodland creature but also a symbol of purity and grace. Here is one of most accurate representation of the lengendary animal.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="images/unicorn.png" alt="The superb unicorn of the Scottish Highlands" width="50%" />
<p class="caption">
Figure 5.1: The superb unicorn of the Scottish Highlands
</p>
</div>
<p>Despite their image of purity and grace, unicorns (<em>Unicornus legendaricus</em>) are raging fighter when it comes to compete for the best sweets you can find at the bottom of rainbows (unicorn favourite source of food).</p>
<p>We want to know:</p>
<ul>
<li>If aggressiveness differs among individuals</li>
<li>If aggressive behaviour is plastic (change with the environment)</li>
<li>If aggressive behaviour depends on body condition of focal animal
<!-- * If individuals differ in their plasticity --></li>
</ul>
<p>With respect to plasticity, we will focus on rival size as an ‘environment’. Common sense, and animal-contest theory, suggest a small animal would be wise not to escalate an aggressive contest against a larger, stronger rival. However, there are reports in the legendary beasty literature that they get more aggressive as rival size increases. Those reports are based on small sample sizes and uncontrolled field observations by Munro baggers enjoying their whisky after a long day in the hills.</p>
<div id="experimental-design---what-is-the-structure-of-the-data-we-have" class="section level4">
<h4><span class="header-section-number">5.1.1.1</span> Experimental design - what is the structure of the data we have?</h4>
<p>Here, we have measured aggression in a population of wild unicorns. We brought some (n=80) individual into the lab, tagged them so they were individually identifiable, then repeatedly observed their aggression when presented with model ‘intruders’ (animal care committe approved). There were three models; one of average unicorn (calculated as the population mean body length), one that was build to be 1 standard deviation below the population mean, and one that was 1 standard deviation above.</p>
<p>Data were collected on all individuals in two block of lab work. Within each block, each animal was tested 3 times, once against an ‘intruder’ of each size. The test order in which each male experienced the three instruder sizes was randomised in each block. The body size of all focal individuals was measured at the beginning of each block so we know that too (and have two separate measures per individual).</p>
</div>
<div id="data" class="section level4">
<h4><span class="header-section-number">5.1.1.2</span> Data</h4>
<p>Let’s load the data file and make sure we understand what it contains</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="practical-2.html#cb24-1"></a>unicorns &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/unicorns_aggression.csv&quot;</span>)</span></code></pre></div>
<p>You can use <code>summary(unicorns)</code> to get an overview of the data and/or <code>head(unicorns)</code> to see the structure in the first few lines. This data frame has 6 variables:</p>
<ul>
<li>Individual <strong>ID</strong></li>
<li>Experimental <strong>Block</strong>, denoted for now as a continuous variable with possible values of -0.5 (first block) or +0.5 (second block)</li>
<li>Individual <strong>body_size</strong>, as measured at the start of each block in kg</li>
<li>The repeat number for each behavioural test, <strong>assay_rep</strong></li>
<li>Opponent size (<strong>opp_size</strong>), in standard deviations from the mean (i.e., -1,0,1)</li>
<li><strong>aggression</strong>, our behavioural trait, measured 6 times in total per individual (2 blocks of 3 tests)</li>
</ul>
</div>
</div>
<div id="questions-2" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Questions</h3>
<p><strong>1)</strong> Load the libraries (<code>lme4</code>)</p>
<p><strong>2)</strong> Load the data <code>unicorns.csv</code> and look at the summary and data structure</p>
<p><strong>3)</strong> Fit a first mixed model with <code>lmer</code> that have only individual identity as a random effect and only a population mean.</p>
<p><strong>4)</strong> Look at the output of the model (<em>summary()</em>)</p>
<p><strong>5)</strong> This is a fairly rubbish model so now fit a better model by adding opponent size (<em>opp_size</em>) and block (<em>block</em>) as fixed effects. Look at the output of the model (<em>summary()</em>)</p>
<p><strong>6)</strong> Where are the <strong>p-values</strong> ? what I have done wrong. Load <code>lmerTest</code> and refit the model using the exact same code. Look at the summary again.</p>
<p><strong>7)</strong> Testing for random effects using <code>ranova()</code>. You can also do it by hand if you want.</p>
<p><strong>8)</strong> Estimate repeatability, either by hand or using the <code>rpt</code> package</p>
<p><strong>9)</strong> Now what about the effect on an individual body size on its aggression. Do a new model including body size also as a fixed effects. Look at the model output, estimate the probability associated witht eh random effects.</p>
<p><strong>10)</strong> Make a few diagnostic plots before you can get to excited by your results (<em>homoscedasticity</em>, <em>Gaussian distribution for residuals</em>, <em>linear relation</em>, <em>similar within group variance</em> )</p>
<p><strong>11)</strong> Compare repeatability among different models.</p>
</div>
<div id="happy-mixed-modelling" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Happy mixed-modelling</h3>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="images/unicorn.png" alt="The superb unicorn" width="20%" />
<p class="caption">
Figure 5.2: The superb unicorn
</p>
</div>

</div>
</div>
<!-- </div> -->
<script src="js/solution.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="refresher-on-glm-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="refresher-on-glm-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/BIO8940-uOttawa/class_book/02_02-intro_lmm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BIO8940_book.pdf", "BIO8940_book.epub", "BIO8940_book.mobi"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
