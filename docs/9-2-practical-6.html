<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.2 Practical | BIO8940 Advanced stats and Open Science</title>
  <meta name="description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="9.2 Practical | BIO8940 Advanced stats and Open Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/missing.png" />
  <meta property="og:description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="github-repo" content="BIO8940-uOttawa/class_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.2 Practical | BIO8940 Advanced stats and Open Science" />
  
  <meta name="twitter:description" content="Theory and practicals for BIO8940 course at the University of Ottawa" />
  <meta name="twitter:image" content="images/missing.png" />

<meta name="author" content="Julien Martin" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="9-1-theory-2.html"/>
<link rel="next" href="r-1.html"/>
<script src="libs/header-attrs-2.7.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced stats and open science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Note</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="quelques-points-importants-à-retenir.html"><a href="quelques-points-importants-à-retenir.html"><i class="fa fa-check"></i>Quelques points importants à retenir</a></li>
<li class="chapter" data-level="" data-path="quest-ce-que-r-et-pourquoi-lutiliser-dans-ce-cours.html"><a href="quest-ce-que-r-et-pourquoi-lutiliser-dans-ce-cours.html"><i class="fa fa-check"></i>Qu’est-ce que R et pourquoi l’utiliser dans ce cours?</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html"><i class="fa fa-check"></i>Installation des logiciels nécessaires</a>
<ul>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="0.0.1" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#text-editor-or-ide"><i class="fa fa-check"></i><b>0.0.1</b> Text editor or IDE</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#paquets-pour-r"><i class="fa fa-check"></i>Paquets pour R</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#pandoc"><i class="fa fa-check"></i>pandoc</a></li>
<li class="chapter" data-level="" data-path="installation-des-logiciels-nécessaires.html"><a href="installation-des-logiciels-nécessaires.html#latex"><i class="fa fa-check"></i>laTex</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="instructions-générales-pour-les-laboratoires.html"><a href="instructions-générales-pour-les-laboratoires.html"><i class="fa fa-check"></i>Instructions générales pour les laboratoires</a></li>
<li class="chapter" data-level="" data-path="notes-sur-le-manuel.html"><a href="notes-sur-le-manuel.html"><i class="fa fa-check"></i>Notes sur le manuel</a>
<ul>
<li class="chapter" data-level="" data-path="notes-sur-le-manuel.html"><a href="notes-sur-le-manuel.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="notes-sur-le-manuel.html"><a href="notes-sur-le-manuel.html#licence"><i class="fa fa-check"></i>Licence</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Open Science</b></span></li>
<li class="chapter" data-level="1" data-path="1-introduction-to-open-science.html"><a href="1-introduction-to-open-science.html"><i class="fa fa-check"></i><b>1</b> Introduction to open Science</a></li>
<li class="chapter" data-level="2" data-path="2-introduction-to-rmarkdown.html"><a href="2-introduction-to-rmarkdown.html"><i class="fa fa-check"></i><b>2</b> Introduction to Rmarkdown</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2-1-practical.html"><a href="2-1-practical.html"><i class="fa fa-check"></i><b>2.1</b> Practical</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2-1-practical.html"><a href="2-1-practical.html#context"><i class="fa fa-check"></i><b>2.1.1</b> Context</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-1-practical.html"><a href="2-1-practical.html#questions"><i class="fa fa-check"></i><b>2.1.2</b> Questions</a></li>
<li class="chapter" data-level="" data-path="2-1-practical.html"><a href="2-1-practical.html#example-of-output"><i class="fa fa-check"></i>Example of output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-introduction-to-github-with-r.html"><a href="3-introduction-to-github-with-r.html"><i class="fa fa-check"></i><b>3</b> Introduction to github with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-1-practical-1.html"><a href="3-1-practical-1.html"><i class="fa fa-check"></i><b>3.1</b> Practical</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3-1-practical-1.html"><a href="3-1-practical-1.html#context-1"><i class="fa fa-check"></i><b>3.1.1</b> Context</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-1-practical-1.html"><a href="3-1-practical-1.html#information-of-the-data"><i class="fa fa-check"></i><b>3.1.2</b> Information of the data</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-1-practical-1.html"><a href="3-1-practical-1.html#questions-1"><i class="fa fa-check"></i><b>3.1.3</b> Questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Statistics</b></span></li>
<li class="chapter" data-level="4" data-path="4-refresher-on-glm.html"><a href="4-refresher-on-glm.html"><i class="fa fa-check"></i><b>4</b> Refresher on <code>glm</code></a></li>
<li class="chapter" data-level="5" data-path="5-introduction-to-linear-mixed-models.html"><a href="5-introduction-to-linear-mixed-models.html"><i class="fa fa-check"></i><b>5</b> Introduction to linear mixed models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-1-shrinkage.html"><a href="5-1-shrinkage.html"><i class="fa fa-check"></i><b>5.1</b> Shrinkage</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5-1-shrinkage.html"><a href="5-1-shrinkage.html#analysis"><i class="fa fa-check"></i><b>5.1.1</b> Analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-1-shrinkage.html"><a href="5-1-shrinkage.html#data"><i class="fa fa-check"></i><b>5.1.2</b> Data</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-1-shrinkage.html"><a href="5-1-shrinkage.html#run-the-baseline-model"><i class="fa fa-check"></i><b>5.1.3</b> Run the baseline model</a></li>
<li class="chapter" data-level="5.1.4" data-path="5-1-shrinkage.html"><a href="5-1-shrinkage.html#visualize-the-baseline-model"><i class="fa fa-check"></i><b>5.1.4</b> Visualize the baseline model</a></li>
<li class="chapter" data-level="5.1.5" data-path="5-1-shrinkage.html"><a href="5-1-shrinkage.html#summary"><i class="fa fa-check"></i><b>5.1.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html"><i class="fa fa-check"></i><b>5.2</b> Practical</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#overview"><i class="fa fa-check"></i><b>5.2.1</b> Overview</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#r-packages-needed"><i class="fa fa-check"></i><b>5.2.2</b> R packages needed</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#the-superb-wild-unicorns-of-the-scottish-highlands"><i class="fa fa-check"></i><b>5.2.3</b> The superb wild unicorns of the Scottish Highlands</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#do-unicorns-differ-in-aggressiveness-your-first-mixed-model"><i class="fa fa-check"></i><b>5.2.4</b> Do unicorns differ in aggressiveness? Your first mixed model</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#do-unicorns-differ-in-aggressiveness-a-better-mixed-model"><i class="fa fa-check"></i><b>5.2.5</b> Do unicorns differ in aggressiveness? A better mixed model</a></li>
<li class="chapter" data-level="5.2.6" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#what-is-the-repeatability"><i class="fa fa-check"></i><b>5.2.6</b> What is the repeatability?</a></li>
<li class="chapter" data-level="5.2.7" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#a-quick-note-on-uncertainty"><i class="fa fa-check"></i><b>5.2.7</b> A quick note on uncertainty</a></li>
<li class="chapter" data-level="5.2.8" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#an-easy-way-to-mess-up-your-mixed-models"><i class="fa fa-check"></i><b>5.2.8</b> An easy way to mess up your mixed models</a></li>
<li class="chapter" data-level="5.2.9" data-path="5-2-practical-2.html"><a href="5-2-practical-2.html#happy-mixed-modelling"><i class="fa fa-check"></i><b>5.2.9</b> Happy mixed-modelling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-introduction-to-glmm.html"><a href="6-introduction-to-glmm.html"><i class="fa fa-check"></i><b>6</b> Introduction to <code>GLMM</code></a>
<ul>
<li class="chapter" data-level="6.1" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html"><i class="fa fa-check"></i><b>6.1</b> Practical</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#packages-and-functions"><i class="fa fa-check"></i><b>6.1.1</b> Packages and functions</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#the-data-set"><i class="fa fa-check"></i><b>6.1.2</b> The data set</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#specifying-fixed-and-random-effects"><i class="fa fa-check"></i><b>6.1.3</b> Specifying fixed and random Effects</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#look-at-overall-patterns-in-data"><i class="fa fa-check"></i><b>6.1.4</b> Look at overall patterns in data</a></li>
<li class="chapter" data-level="6.1.5" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#choose-an-error-distribution"><i class="fa fa-check"></i><b>6.1.5</b> Choose an error distribution</a></li>
<li class="chapter" data-level="6.1.6" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#fitting-group-wise-glm"><i class="fa fa-check"></i><b>6.1.6</b> Fitting group-wise GLM</a></li>
<li class="chapter" data-level="6.1.7" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#fitting-and-evaluating-glmms"><i class="fa fa-check"></i><b>6.1.7</b> Fitting and evaluating GLMMs</a></li>
<li class="chapter" data-level="6.1.8" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#inference"><i class="fa fa-check"></i><b>6.1.8</b> Inference</a></li>
<li class="chapter" data-level="6.1.9" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#conclusions"><i class="fa fa-check"></i><b>6.1.9</b> Conclusions</a></li>
<li class="chapter" data-level="6.1.10" data-path="6-1-practical-3.html"><a href="6-1-practical-3.html#happy-generalized-mixed-modelling"><i class="fa fa-check"></i><b>6.1.10</b> Happy generalized mixed-modelling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-introduction-to-bayesian-inference.html"><a href="7-introduction-to-bayesian-inference.html"><i class="fa fa-check"></i><b>7</b> Introduction to <code>Bayesian Inference</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="7-1-theory.html"><a href="7-1-theory.html"><i class="fa fa-check"></i><b>7.1</b> theory</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7-1-theory.html"><a href="7-1-theory.html#bayes-theorem"><i class="fa fa-check"></i><b>7.1.1</b> Bayes’ theorem</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-1-theory.html"><a href="7-1-theory.html#intro-to-mcmc"><i class="fa fa-check"></i><b>7.1.2</b> Intro to MCMC</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-1-theory.html"><a href="7-1-theory.html#inferences-1"><i class="fa fa-check"></i><b>7.1.3</b> Inferences</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html"><i class="fa fa-check"></i><b>7.2</b> Practical</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html#r-packages-needed-1"><i class="fa fa-check"></i><b>7.2.1</b> R packages needed</a></li>
<li class="chapter" data-level="7.2.2" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html#a-refresher-on-unicorn-ecology"><i class="fa fa-check"></i><b>7.2.2</b> A refresher on unicorn ecology</a></li>
<li class="chapter" data-level="7.2.3" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html#mcmcglmm"><i class="fa fa-check"></i><b>7.2.3</b> MCMCglmm</a></li>
<li class="chapter" data-level="7.2.4" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html#inferences-2"><i class="fa fa-check"></i><b>7.2.4</b> Inferences</a></li>
<li class="chapter" data-level="7.2.5" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html#brms"><i class="fa fa-check"></i><b>7.2.5</b> brms</a></li>
<li class="chapter" data-level="7.2.6" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html#inferences-3"><i class="fa fa-check"></i><b>7.2.6</b> Inferences</a></li>
<li class="chapter" data-level="7.2.7" data-path="7-2-practical-4.html"><a href="7-2-practical-4.html#happy-bayesian-stats"><i class="fa fa-check"></i><b>7.2.7</b> Happy Bayesian stats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-multivariate-mixed-models.html"><a href="8-multivariate-mixed-models.html"><i class="fa fa-check"></i><b>8</b> Multivariate mixed models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8-1-theory-1.html"><a href="8-1-theory-1.html"><i class="fa fa-check"></i><b>8.1</b> theory</a></li>
<li class="chapter" data-level="8.2" data-path="8-2-practical-5.html"><a href="8-2-practical-5.html"><i class="fa fa-check"></i><b>8.2</b> Practical</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8-2-practical-5.html"><a href="8-2-practical-5.html#r-packages-needed-2"><i class="fa fa-check"></i><b>8.2.1</b> R packages needed</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-2-practical-5.html"><a href="8-2-practical-5.html#the-blue-dragon-of-the-east"><i class="fa fa-check"></i><b>8.2.2</b> The blue dragon of the East</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-2-practical-5.html"><a href="8-2-practical-5.html#multiple-univariate-models"><i class="fa fa-check"></i><b>8.2.3</b> Multiple univariate models</a></li>
<li class="chapter" data-level="8.2.4" data-path="8-2-practical-5.html"><a href="8-2-practical-5.html#multivariate-approach"><i class="fa fa-check"></i><b>8.2.4</b> Multivariate approach</a></li>
<li class="chapter" data-level="8.2.5" data-path="8-2-practical-5.html"><a href="8-2-practical-5.html#happy-multivariate-models"><i class="fa fa-check"></i><b>8.2.5</b> Happy multivariate models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-random-regression-and-character-state-approaches.html"><a href="9-random-regression-and-character-state-approaches.html"><i class="fa fa-check"></i><b>9</b> Random regression and character state approaches</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9-1-theory-2.html"><a href="9-1-theory-2.html"><i class="fa fa-check"></i><b>9.1</b> theory</a></li>
<li class="chapter" data-level="9.2" data-path="9-2-practical-6.html"><a href="9-2-practical-6.html"><i class="fa fa-check"></i><b>9.2</b> Practical</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="9-2-practical-6.html"><a href="9-2-practical-6.html#r-packages-needed-3"><i class="fa fa-check"></i><b>9.2.1</b> R packages needed</a></li>
<li class="chapter" data-level="9.2.2" data-path="9-2-practical-6.html"><a href="9-2-practical-6.html#refresher-on-unicorn-aggression"><i class="fa fa-check"></i><b>9.2.2</b> Refresher on unicorn aggression</a></li>
<li class="chapter" data-level="9.2.3" data-path="9-2-practical-6.html"><a href="9-2-practical-6.html#random-regression"><i class="fa fa-check"></i><b>9.2.3</b> Random regression</a></li>
<li class="chapter" data-level="9.2.4" data-path="9-2-practical-6.html"><a href="9-2-practical-6.html#character-state-approach"><i class="fa fa-check"></i><b>9.2.4</b> Character-State approach</a></li>
<li class="chapter" data-level="9.2.5" data-path="9-2-practical-6.html"><a href="9-2-practical-6.html#conclusions-2"><i class="fa fa-check"></i><b>9.2.5</b> Conclusions</a></li>
<li class="chapter" data-level="9.2.6" data-path="9-2-practical-6.html"><a href="9-2-practical-6.html#happy-multivariate-models-1"><i class="fa fa-check"></i><b>9.2.6</b> Happy multivariate models</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="" data-path="r-1.html"><a href="r-1.html"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="to-do-list.html"><a href="to-do-list.html"><i class="fa fa-check"></i>To do list</a></li>
<li class="chapter" data-level="" data-path="list-of-r-packages-used-in-this-book.html"><a href="list-of-r-packages-used-in-this-book.html"><i class="fa fa-check"></i>List of R packages used in this book</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIO8940 Advanced stats and Open Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practical-6" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Practical</h2>
<p>In this practical, we will revisit our analysis on unicorn aggressivity.
Honestly, we can use any other data with repeated measures for this exercise
but I just ❤️ unicorns.</p>
<div id="r-packages-needed-3" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> R packages needed</h3>
<p>First we load required libraries</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="9-2-practical-6.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb270-2"><a href="9-2-practical-6.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb270-3"><a href="9-2-practical-6.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed)</span>
<span id="cb270-4"><a href="9-2-practical-6.html#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(asreml)</span>
<span id="cb270-5"><a href="9-2-practical-6.html#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCglmm)</span>
<span id="cb270-6"><a href="9-2-practical-6.html#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span></code></pre></div>
</div>
<div id="refresher-on-unicorn-aggression" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Refresher on unicorn aggression</h3>
<p>In the previous, practical on linear mixed models, we simply explored the differences among individuals in their mean aggression (Intercept), but we assumed that the response to the change in aggression with the opponent size (i.e. plasticity) was the same for all individuals. However, this plastic responses can also vary amon individuals. This is called IxE, or individual by environment interaction. To test if individuals differ in their plasticity we can use a random regression, whcih is simply a mixed-model where we fit both a random intercept and a random slope effect.</p>
<p>Following analysis from the previous pratical, our model of interest using scaled covariate was:</p>
<pre><code>aggression ~ opp_size + body_size_sc + assay_rep_sc + block
              + (1 | ID)</code></pre>
<p>We should start by loading the data and refitting the model using <code>lmer()</code>.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="9-2-practical-6.html#cb272-1" aria-hidden="true" tabindex="-1"></a>unicorns <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/unicorns_aggression.csv&quot;</span>)</span>
<span id="cb272-2"><a href="9-2-practical-6.html#cb272-2" aria-hidden="true" tabindex="-1"></a>unicorns <span class="ot">&lt;-</span> unicorns <span class="sc">%&gt;%</span></span>
<span id="cb272-3"><a href="9-2-practical-6.html#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb272-4"><a href="9-2-practical-6.html#cb272-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">body_size_sc =</span> <span class="fu">scale</span>(body_size),</span>
<span id="cb272-5"><a href="9-2-practical-6.html#cb272-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">assay_rep_sc =</span> <span class="fu">scale</span>(assay_rep, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb272-6"><a href="9-2-practical-6.html#cb272-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb272-7"><a href="9-2-practical-6.html#cb272-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-8"><a href="9-2-practical-6.html#cb272-8" aria-hidden="true" tabindex="-1"></a>m_mer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb272-9"><a href="9-2-practical-6.html#cb272-9" aria-hidden="true" tabindex="-1"></a>    aggression <span class="sc">~</span> opp_size <span class="sc">+</span> body_size_sc <span class="sc">+</span> assay_rep_sc <span class="sc">+</span> block</span>
<span id="cb272-10"><a href="9-2-practical-6.html#cb272-10" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID),</span>
<span id="cb272-11"><a href="9-2-practical-6.html#cb272-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> unicorns</span>
<span id="cb272-12"><a href="9-2-practical-6.html#cb272-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb272-13"><a href="9-2-practical-6.html#cb272-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mer)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: aggression ~ opp_size + body_size_sc + assay_rep_sc + block +      (1 | ID)
##    Data: unicorns
## 
## REML criterion at convergence: 1136.5
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.85473 -0.62831  0.02545  0.68998  2.74064 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  ID       (Intercept) 0.02538  0.1593  
##  Residual             0.58048  0.7619  
## Number of obs: 480, groups:  ID, 80
## 
## Fixed effects:
##               Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)    9.00181    0.03907  78.07315 230.395   &lt;2e-16 ***
## opp_size       1.05141    0.04281 396.99857  24.562   &lt;2e-16 ***
## body_size_sc   0.03310    0.03896  84.21144   0.850    0.398    
## assay_rep_sc  -0.05783    0.04281 396.99857  -1.351    0.177    
## block         -0.02166    0.06955 397.00209  -0.311    0.756    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) opp_sz bdy_s_ assy__
## opp_size     0.000                     
## body_siz_sc  0.000  0.000              
## assay_rp_sc  0.000 -0.100  0.000       
## block        0.000  0.000  0.002  0.000</code></pre>
<p>We can now plot the predictions for each of our observations and plot for the observed and the fitted data for each individuals. Todo so we will use the <code>augment()</code> function from the 📦 <code>broom.mixed</code>.</p>
<p>Below, we plot the raw data for each individual in one panel, with the fitted slopes in a second panel. Because
we have 2 blocks of data, and block is fitted as a fixed effect, for ease of presentation we need to either select only 1 block for representation, take teh avaerage over the block effect or do a more complex graph with the two blocks. Here I have selected only one of the blocks for this plot</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="9-2-practical-6.html#cb274-1" aria-hidden="true" tabindex="-1"></a>pred_m_mer <span class="ot">&lt;-</span> <span class="fu">augment</span>(m_mer) <span class="sc">%&gt;%</span></span>
<span id="cb274-2"><a href="9-2-practical-6.html#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, block, opp_size, .fitted, aggression) <span class="sc">%&gt;%</span></span>
<span id="cb274-3"><a href="9-2-practical-6.html#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(block <span class="sc">==</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb274-4"><a href="9-2-practical-6.html#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(</span>
<span id="cb274-5"><a href="9-2-practical-6.html#cb274-5" aria-hidden="true" tabindex="-1"></a>    type, aggression,</span>
<span id="cb274-6"><a href="9-2-practical-6.html#cb274-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">.fitted</span><span class="st">`</span><span class="sc">:</span>aggression</span>
<span id="cb274-7"><a href="9-2-practical-6.html#cb274-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb274-8"><a href="9-2-practical-6.html#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_m_mer, <span class="fu">aes</span>(<span class="at">x =</span> opp_size, <span class="at">y =</span> aggression, <span class="at">group =</span> ID)) <span class="sc">+</span></span>
<span id="cb274-9"><a href="9-2-practical-6.html#cb274-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb274-10"><a href="9-2-practical-6.html#cb274-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb274-11"><a href="9-2-practical-6.html#cb274-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-125"></span>
<img src="BIO8940_book_files/figure-html/unnamed-chunk-125-1.svg" alt="Predicted (from m_mer) and observed value of aggression as a function of opponent size in unicorns" width="672" />
<p class="caption">
Figure 9.2: Predicted (from m_mer) and observed value of aggression as a function of opponent size in unicorns
</p>
</div>
<p>This illustrates the importance of using model predictions to see whether the model actually fits the individual-level data well or not — while the diagnostic plots looked fine, and the model captures mean plasticity, here we can see that the model really doesn’t fit the actual data very well at all.</p>
<!--The code below provides a different (and slightly more in-depth) look at this same combination of fitted slope / real data, and indicates that the fitted slopes systematically under- and over-estimate plasticity
in aggression at the individual level (figure not shown since it has 80 panels).

need to figure out the code
-->
</div>
<div id="random-regression" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Random regression</h3>
<div id="with-lme4" class="section level4" number="9.2.3.1">
<h4><span class="header-section-number">9.2.3.1</span> with <code>lme4</code></h4>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="9-2-practical-6.html#cb275-1" aria-hidden="true" tabindex="-1"></a>rr_mer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb275-2"><a href="9-2-practical-6.html#cb275-2" aria-hidden="true" tabindex="-1"></a>  aggression <span class="sc">~</span> opp_size <span class="sc">+</span> body_size_sc <span class="sc">+</span> assay_rep_sc <span class="sc">+</span> block</span>
<span id="cb275-3"><a href="9-2-practical-6.html#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> opp_size <span class="sc">|</span> ID),</span>
<span id="cb275-4"><a href="9-2-practical-6.html#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> unicorns</span>
<span id="cb275-5"><a href="9-2-practical-6.html#cb275-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="9-2-practical-6.html#cb276-1" aria-hidden="true" tabindex="-1"></a>pred_rr_mer <span class="ot">&lt;-</span> <span class="fu">augment</span>(rr_mer) <span class="sc">%&gt;%</span></span>
<span id="cb276-2"><a href="9-2-practical-6.html#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, block, opp_size, .fitted, aggression) <span class="sc">%&gt;%</span></span>
<span id="cb276-3"><a href="9-2-practical-6.html#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(block <span class="sc">==</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb276-4"><a href="9-2-practical-6.html#cb276-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(type,aggression, <span class="st">`</span><span class="at">.fitted</span><span class="st">`</span><span class="sc">:</span>aggression)</span>
<span id="cb276-5"><a href="9-2-practical-6.html#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_rr_mer, <span class="fu">aes</span>(<span class="at">x =</span> opp_size, <span class="at">y =</span> aggression, <span class="at">group =</span> ID)) <span class="sc">+</span></span>
<span id="cb276-6"><a href="9-2-practical-6.html#cb276-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb276-7"><a href="9-2-practical-6.html#cb276-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb276-8"><a href="9-2-practical-6.html#cb276-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> type)</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-127-1.svg" width="672" /></p>
<p>We can test the improvement of the model fit using the overloaded anova function in R to perform a likelihood ratio test (LRT):</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="9-2-practical-6.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(rr_mer, m_mer, <span class="at">refit =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">npar</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">logLik</th>
<th align="right">deviance</th>
<th align="right">Chisq</th>
<th align="right">Df</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m_mer</td>
<td align="right">7</td>
<td align="right">1150.477</td>
<td align="right">1179.693</td>
<td align="right">-568.2383</td>
<td align="right">1136.477</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">rr_mer</td>
<td align="right">9</td>
<td align="right">1092.356</td>
<td align="right">1129.920</td>
<td align="right">-537.1780</td>
<td align="right">1074.356</td>
<td align="right">62.1206</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We can see here that the LRT uses a chi-square test with 2 degrees of freedom, and indicates that the random slopes model shows a statistically significant improvement in model fit. The 2df are because there are two additional (co)variance terms estimated in the random regression model: a variance term for individual slopes, and the covariance (or correlation) between the slopes and intercepts. Let’s look at those values, and also the fixed effects parameters, via the model summary:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="9-2-practical-6.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rr_mer)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [&#39;lmerModLmerTest&#39;]
## Formula: aggression ~ opp_size + body_size_sc + assay_rep_sc + block +      (1 + opp_size | ID)
##    Data: unicorns
## 
## REML criterion at convergence: 1074.4
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.04932 -0.59780 -0.02002  0.59574  2.68010 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  ID       (Intercept) 0.05043  0.2246       
##           opp_size    0.19167  0.4378   0.96
##  Residual             0.42816  0.6543       
## Number of obs: 480, groups:  ID, 80
## 
## Fixed effects:
##               Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)    9.00181    0.03902  78.44088 230.707   &lt;2e-16 ***
## opp_size       1.05033    0.06123  79.50694  17.153   &lt;2e-16 ***
## body_size_sc   0.02725    0.03377  84.34959   0.807    0.422    
## assay_rep_sc  -0.04702    0.03945 387.69415  -1.192    0.234    
## block         -0.02169    0.05973 318.19553  -0.363    0.717    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) opp_sz bdy_s_ assy__
## opp_size     0.495                     
## body_siz_sc  0.000  0.000              
## assay_rp_sc  0.000 -0.064 -0.006       
## block        0.000  0.000  0.002  0.000</code></pre>
</div>
<div id="with-asreml" class="section level4" number="9.2.3.2">
<h4><span class="header-section-number">9.2.3.2</span> with <code>asreml</code></h4>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="9-2-practical-6.html#cb280-1" aria-hidden="true" tabindex="-1"></a>unicorns <span class="ot">&lt;-</span> unicorns <span class="sc">%&gt;%</span></span>
<span id="cb280-2"><a href="9-2-practical-6.html#cb280-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">ID =</span> <span class="fu">as.factor</span>(ID))</span>
<span id="cb280-3"><a href="9-2-practical-6.html#cb280-3" aria-hidden="true" tabindex="-1"></a>rr_asr <span class="ot">&lt;-</span> <span class="fu">asreml</span>(</span>
<span id="cb280-4"><a href="9-2-practical-6.html#cb280-4" aria-hidden="true" tabindex="-1"></a>  aggression <span class="sc">~</span> opp_size <span class="sc">+</span> body_size_sc <span class="sc">+</span> assay_rep_sc <span class="sc">+</span> block,</span>
<span id="cb280-5"><a href="9-2-practical-6.html#cb280-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span><span class="fu">str</span>(<span class="sc">~</span> ID <span class="sc">+</span> ID<span class="sc">:</span>opp_size, <span class="sc">~</span><span class="fu">us</span>(<span class="dv">2</span>)<span class="sc">:</span><span class="fu">id</span>(ID)),</span>
<span id="cb280-6"><a href="9-2-practical-6.html#cb280-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">residual =</span> <span class="sc">~</span> units,</span>
<span id="cb280-7"><a href="9-2-practical-6.html#cb280-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> unicorns,</span>
<span id="cb280-8"><a href="9-2-practical-6.html#cb280-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">200</span></span>
<span id="cb280-9"><a href="9-2-practical-6.html#cb280-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Model fitted using the gamma parameterization.
## ASReml 4.1.0 Mon Mar 22 12:19:45 2021
##           LogLik        Sigma2     DF     wall    cpu
##  1      -109.426      0.463232    475 12:19:45    0.0
##  2      -105.050      0.454593    475 12:19:45    0.0
##  3      -101.814      0.443662    475 12:19:45    0.0
##  4      -100.814      0.433873    475 12:19:45    0.0
##  5      -100.683      0.428596    475 12:19:45    0.0
##  6      -100.682      0.428170    475 12:19:45    0.0</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="9-2-practical-6.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rr_asr)</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-132-1.svg" width="672" /></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="9-2-practical-6.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rr_asr, <span class="at">coef =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>coef.fixed</span></code></pre></div>
<pre><code>##                 solution  std error     z.ratio
## block        -0.02168725 0.05973354  -0.3630665
## assay_rep_sc -0.04702032 0.03944594  -1.1920191
## body_size_sc  0.02725092 0.03377443   0.8068506
## opp_size      1.05032703 0.06123110  17.1534907
## (Intercept)   9.00181250 0.03901766 230.7112239</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="9-2-practical-6.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.asreml</span>(rr_asr, <span class="at">ssType =</span> <span class="st">&quot;conditional&quot;</span>, <span class="at">denDF =</span> <span class="st">&quot;numeric&quot;</span>)</span></code></pre></div>
<pre><code>## Model fitted using the gamma parameterization.
## ASReml 4.1.0 Mon Mar 22 12:19:46 2021
##           LogLik        Sigma2     DF     wall    cpu
##  1      -100.682      0.428168    475 12:19:46    0.0
##  2      -100.682      0.428168    475 12:19:46    0.0
## Calculating denominator DF</code></pre>
<pre><code>## $Wald
## [0;34m
## Wald tests for fixed effects.[0m
## [0;34mResponse: aggression[0m
## 
##              Df denDF F.inc F.con Margin      Pr
## (Intercept)   1  78.3 65490 53230        0.00000
## opp_size      1  79.5   293   294      A 0.00000
## body_size_sc  1  84.3     1     1      A 0.42202
## assay_rep_sc  1 387.6     1     1      A 0.23398
## block         1 318.1     0     0      A 0.71680
## 
## $stratumVariances
##                                 df  Variance ID+ID:opp_size!us(2)_1:1 ID+ID:opp_size!us(2)_2:1 ID+ID:opp_size!us(2)_2:2 units!R
## ID+ID:opp_size!us(2)_1:1  78.00483 0.4790737                 5.216311                -3.301137                0.5221955       1
## ID+ID:opp_size!us(2)_2:1   0.00000 0.0000000                 0.000000                 0.000000                0.0000000       1
## ID+ID:opp_size!us(2)_2:2  78.94046 1.1937287                 0.000000                 0.000000                3.9943993       1
## units!R                  318.05470 0.4281680                 0.000000                 0.000000                0.0000000       1</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="9-2-practical-6.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rr_asr)<span class="sc">$</span>varcomp</span></code></pre></div>
<pre><code>##                           component  std.error   z.ratio bound %ch
## ID+ID:opp_size!us(2)_1:1 0.05042932 0.02027564  2.487187     P   0
## ID+ID:opp_size!us(2)_2:1 0.09458336 0.02400745  3.939751     P   0
## ID+ID:opp_size!us(2)_2:2 0.19165924 0.04832059  3.966409     P   0
## units!R                  0.42816954 0.03395320 12.610582     P   0</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="9-2-practical-6.html#cb290-1" aria-hidden="true" tabindex="-1"></a>rio_asr <span class="ot">&lt;-</span> <span class="fu">asreml</span>(</span>
<span id="cb290-2"><a href="9-2-practical-6.html#cb290-2" aria-hidden="true" tabindex="-1"></a>  aggression <span class="sc">~</span> opp_size <span class="sc">+</span> body_size_sc <span class="sc">+</span> assay_rep_sc <span class="sc">+</span> block,</span>
<span id="cb290-3"><a href="9-2-practical-6.html#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> ID,</span>
<span id="cb290-4"><a href="9-2-practical-6.html#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">residual =</span> <span class="sc">~</span>units,</span>
<span id="cb290-5"><a href="9-2-practical-6.html#cb290-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> unicorns,</span>
<span id="cb290-6"><a href="9-2-practical-6.html#cb290-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">200</span></span>
<span id="cb290-7"><a href="9-2-practical-6.html#cb290-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Model fitted using the gamma parameterization.
## ASReml 4.1.0 Mon Mar 22 12:19:46 2021
##           LogLik        Sigma2     DF     wall    cpu
##  1      -132.611      0.560353    475 12:19:46    0.0
##  2      -132.106      0.567043    475 12:19:46    0.0
##  3      -131.796      0.575157    475 12:19:46    0.0
##  4      -131.743      0.580762    475 12:19:46    0.0
##  5      -131.742      0.580480    475 12:19:46    0.0</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="9-2-practical-6.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="dv">2</span> <span class="sc">*</span> (rr_asr<span class="sc">$</span>loglik <span class="sc">-</span> rio_asr<span class="sc">$</span>loglik), <span class="dv">2</span>,</span>
<span id="cb292-2"><a href="9-2-practical-6.html#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb292-3"><a href="9-2-practical-6.html#cb292-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] 3.241026e-14</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="9-2-practical-6.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vpredict</span>(rr_asr, cor_is <span class="sc">~</span> V2 <span class="sc">/</span> (<span class="fu">sqrt</span>(V1) <span class="sc">*</span> <span class="fu">sqrt</span>(V3)))</span></code></pre></div>
<pre><code>##         Estimate        SE
## cor_is 0.9620736 0.1773965</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="9-2-practical-6.html#cb296-1" aria-hidden="true" tabindex="-1"></a>pred_rr_asr <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(rr_asr,</span>
<span id="cb296-2"><a href="9-2-practical-6.html#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">classify =</span> <span class="st">&quot;opp_size:ID&quot;</span>,</span>
<span id="cb296-3"><a href="9-2-practical-6.html#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">list</span>(</span>
<span id="cb296-4"><a href="9-2-practical-6.html#cb296-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;opp_size&quot;</span> <span class="ot">=</span></span>
<span id="cb296-5"><a href="9-2-practical-6.html#cb296-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="at">opp_size =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb296-6"><a href="9-2-practical-6.html#cb296-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb296-7"><a href="9-2-practical-6.html#cb296-7" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>pvals)</span></code></pre></div>
<pre><code>## Model fitted using the gamma parameterization.
## ASReml 4.1.0 Mon Mar 22 12:24:41 2021
##           LogLik        Sigma2     DF     wall    cpu
##  1      -100.682      0.428168    475 12:24:41    0.1
##  2      -100.682      0.428168    475 12:24:41    0.0
##  3      -100.682      0.428168    475 12:24:41    0.0</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="9-2-practical-6.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_rr_asr, <span class="fu">aes</span>(<span class="at">x =</span> opp_size,</span>
<span id="cb298-2"><a href="9-2-practical-6.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> predicted.value,</span>
<span id="cb298-3"><a href="9-2-practical-6.html#cb298-3" aria-hidden="true" tabindex="-1"></a><span class="at">group =</span> ID)) <span class="sc">+</span></span>
<span id="cb298-4"><a href="9-2-practical-6.html#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb298-5"><a href="9-2-practical-6.html#cb298-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb298-6"><a href="9-2-practical-6.html#cb298-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb298-7"><a href="9-2-practical-6.html#cb298-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Opponent size (SDU)&quot;</span>,</span>
<span id="cb298-8"><a href="9-2-practical-6.html#cb298-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Aggression&quot;</span></span>
<span id="cb298-9"><a href="9-2-practical-6.html#cb298-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb298-10"><a href="9-2-practical-6.html#cb298-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-138-1.svg" width="672" /></p>
</div>
<div id="with-mcmcglmm" class="section level4" number="9.2.3.3">
<h4><span class="header-section-number">9.2.3.3</span> with <code>MCMCglmm</code></h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="9-2-practical-6.html#cb299-1" aria-hidden="true" tabindex="-1"></a>prior_RR <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb299-2"><a href="9-2-practical-6.html#cb299-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="dv">1</span>, <span class="at">nu =</span> <span class="fl">0.002</span>),</span>
<span id="cb299-3"><a href="9-2-practical-6.html#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">G =</span> <span class="fu">list</span>(</span>
<span id="cb299-4"><a href="9-2-practical-6.html#cb299-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">G1 =</span> <span class="fu">list</span>(<span class="at">V =</span> <span class="fu">diag</span>(<span class="dv">2</span>)<span class="sc">*</span><span class="fl">0.02</span>, <span class="at">nu =</span> <span class="dv">3</span>,</span>
<span id="cb299-5"><a href="9-2-practical-6.html#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="at">alpha.mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb299-6"><a href="9-2-practical-6.html#cb299-6" aria-hidden="true" tabindex="-1"></a><span class="at">alpha.V=</span> <span class="fu">diag</span>(<span class="dv">1000</span>, <span class="dv">2</span>, <span class="dv">2</span>))))</span>
<span id="cb299-7"><a href="9-2-practical-6.html#cb299-7" aria-hidden="true" tabindex="-1"></a>rr_mcmc <span class="ot">&lt;-</span> <span class="fu">MCMCglmm</span>(</span>
<span id="cb299-8"><a href="9-2-practical-6.html#cb299-8" aria-hidden="true" tabindex="-1"></a>  aggression <span class="sc">~</span> opp_size <span class="sc">+</span> assay_rep_sc <span class="sc">+</span> body_size_sc <span class="sc">+</span> block,</span>
<span id="cb299-9"><a href="9-2-practical-6.html#cb299-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">random =</span> <span class="sc">~</span> <span class="fu">us</span>(<span class="dv">1</span> <span class="sc">+</span> opp_size)<span class="sc">:</span>ID,</span>
<span id="cb299-10"><a href="9-2-practical-6.html#cb299-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">rcov =</span> <span class="sc">~</span> units,</span>
<span id="cb299-11"><a href="9-2-practical-6.html#cb299-11" aria-hidden="true" tabindex="-1"></a><span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb299-12"><a href="9-2-practical-6.html#cb299-12" aria-hidden="true" tabindex="-1"></a><span class="at">prior =</span> prior_RR,</span>
<span id="cb299-13"><a href="9-2-practical-6.html#cb299-13" aria-hidden="true" tabindex="-1"></a><span class="at">nitt=</span><span class="dv">750000</span>,</span>
<span id="cb299-14"><a href="9-2-practical-6.html#cb299-14" aria-hidden="true" tabindex="-1"></a><span class="at">burnin=</span><span class="dv">50000</span>,</span>
<span id="cb299-15"><a href="9-2-practical-6.html#cb299-15" aria-hidden="true" tabindex="-1"></a><span class="at">thin=</span><span class="dv">350</span>,</span>
<span id="cb299-16"><a href="9-2-practical-6.html#cb299-16" aria-hidden="true" tabindex="-1"></a><span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb299-17"><a href="9-2-practical-6.html#cb299-17" aria-hidden="true" tabindex="-1"></a><span class="at">data =</span> unicorns,</span>
<span id="cb299-18"><a href="9-2-practical-6.html#cb299-18" aria-hidden="true" tabindex="-1"></a><span class="at">pr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb299-19"><a href="9-2-practical-6.html#cb299-19" aria-hidden="true" tabindex="-1"></a><span class="at">saveX =</span> <span class="cn">TRUE</span>, <span class="at">saveZ =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="9-2-practical-6.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rr_mcmc<span class="sc">$</span>VCV)</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-140-1.svg" width="672" /><img src="BIO8940_book_files/figure-html/unnamed-chunk-140-2.svg" width="672" /></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="9-2-practical-6.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(rr_mcmc<span class="sc">$</span>VCV[, <span class="st">&quot;opp_size:opp_size.ID&quot;</span>]) <span class="co"># mean</span></span></code></pre></div>
<pre><code>##      var1 
## 0.2040523</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="9-2-practical-6.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(rr_mcmc<span class="sc">$</span>VCV[, <span class="st">&quot;opp_size:opp_size.ID&quot;</span>])</span></code></pre></div>
<pre><code>##          lower     upper
## var1 0.1172616 0.3094872
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="9-2-practical-6.html#cb305-1" aria-hidden="true" tabindex="-1"></a>rr_cor_mcmc <span class="ot">&lt;-</span> rr_mcmc<span class="sc">$</span>VCV[, <span class="st">&quot;opp_size:(Intercept).ID&quot;</span>] <span class="sc">/</span></span>
<span id="cb305-2"><a href="9-2-practical-6.html#cb305-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">sqrt</span>(rr_mcmc<span class="sc">$</span>VCV[, <span class="st">&quot;(Intercept):(Intercept).ID&quot;</span>]) <span class="sc">*</span></span>
<span id="cb305-3"><a href="9-2-practical-6.html#cb305-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(rr_mcmc<span class="sc">$</span>VCV[, <span class="st">&quot;opp_size:opp_size.ID&quot;</span>]))</span>
<span id="cb305-4"><a href="9-2-practical-6.html#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior.mode</span>(rr_cor_mcmc)</span></code></pre></div>
<pre><code>##      var1 
## 0.8466038</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="9-2-practical-6.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HPDinterval</span>(rr_cor_mcmc)</span></code></pre></div>
<pre><code>##          lower     upper
## var1 0.5169232 0.9749839
## attr(,&quot;Probability&quot;)
## [1] 0.95</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="9-2-practical-6.html#cb309-1" aria-hidden="true" tabindex="-1"></a>df_rand <span class="ot">&lt;-</span> <span class="fu">cbind</span>(unicorns,</span>
<span id="cb309-2"><a href="9-2-practical-6.html#cb309-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">rr_fit =</span> <span class="fu">predict</span>(rr_mcmc, <span class="at">marginal =</span> <span class="cn">NULL</span>)</span>
<span id="cb309-3"><a href="9-2-practical-6.html#cb309-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb309-4"><a href="9-2-practical-6.html#cb309-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, opp_size, rr_fit, aggression) <span class="sc">%&gt;%</span></span>
<span id="cb309-5"><a href="9-2-practical-6.html#cb309-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID, opp_size) <span class="sc">%&gt;%</span></span>
<span id="cb309-6"><a href="9-2-practical-6.html#cb309-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb309-7"><a href="9-2-practical-6.html#cb309-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rr_fit =</span> <span class="fu">mean</span>(rr_fit),</span>
<span id="cb309-8"><a href="9-2-practical-6.html#cb309-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">aggression =</span> <span class="fu">mean</span>(aggression)</span>
<span id="cb309-9"><a href="9-2-practical-6.html#cb309-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb309-10"><a href="9-2-practical-6.html#cb309-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(</span>
<span id="cb309-11"><a href="9-2-practical-6.html#cb309-11" aria-hidden="true" tabindex="-1"></a>    Type, Value,</span>
<span id="cb309-12"><a href="9-2-practical-6.html#cb309-12" aria-hidden="true" tabindex="-1"></a>    rr_fit<span class="sc">:</span>aggression</span>
<span id="cb309-13"><a href="9-2-practical-6.html#cb309-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;ID&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="9-2-practical-6.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot separate panels for individual lines of each type</span></span>
<span id="cb311-2"><a href="9-2-practical-6.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_rand, <span class="fu">aes</span>(<span class="at">x =</span> opp_size, <span class="at">y =</span> Value, <span class="at">group =</span> ID)) <span class="sc">+</span></span>
<span id="cb311-3"><a href="9-2-practical-6.html#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb311-4"><a href="9-2-practical-6.html#cb311-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb311-5"><a href="9-2-practical-6.html#cb311-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb311-6"><a href="9-2-practical-6.html#cb311-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(. <span class="sc">~</span> Type)</span></code></pre></div>
<p><img src="BIO8940_book_files/figure-html/unnamed-chunk-143-1.svg" width="672" /></p>
</div>
</div>
<div id="character-state-approach" class="section level3" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Character-State approach</h3>
</div>
<div id="conclusions-2" class="section level3" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> Conclusions</h3>
</div>
<div id="happy-multivariate-models-1" class="section level3" number="9.2.6">
<h3><span class="header-section-number">9.2.6</span> Happy multivariate models</h3>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-144"></span>
<img src="images/blue_dragon.jpg" alt="A female blue dragon of the West" width="50%" />
<p class="caption">
Figure 9.3: A female blue dragon of the West
</p>
</div>

</div>
</div>
<!-- </div> -->



</div>
<script src="js/solution.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="9-1-theory-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/BIO8940-uOttawa/class_book/02_06-randreg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BIO8940_book.pdf", "BIO8940_book.epub", "BIO8940_book.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
